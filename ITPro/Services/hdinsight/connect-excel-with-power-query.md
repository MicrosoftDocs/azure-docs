<properties linkid="manage-services-hdinsight-connect-excel-with-power-query" urlDisplayName="HDInsight and Excel" pageTitle="Connect Excel to HDInsight with Power Query | Windows Azure" metaKeywords="hdinsight, excel, data explorer, hive excel, hdinsight excel, power query" description="Learn how to take advantage of business intelligence components and use Excel to access data stored in Windows Azure HDInsight using Power Query." metaCanonical="" services="hdinsight" documentationCenter="" title="Connect Excel to Windows Azure HDInsight with Power Query" authors=""  solutions="" writer="bradsev" manager="paulettm" editor="mollybos"  />




#Connect Excel to Windows Azure HDInsight with Power Query

One key feature of Microsoftâ€™s big data solution is the integration of  Microsoft Business Intelligence (BI) components with HDInsight Hadoop clusters. A primary example of this integration is the ability to connect Excel to the Windows Azure storage account containing the data associated with your HDInsight cluster by using Microsoft Power Query for Excel. This article walks you through how to set up and use Power Query from Excel to query data associated with an HDInsight cluster. 

**Prerequisites**

Before you begin this article, you must have the following:

- A Windows Azure subscription. For more information about obtaining a subscription, see [Purchase Options][azure-purchase-options], [Member Offers][azure-member-offers], or [Free Trial][azure-free-trial].
- A HDInsight cluster. To configure one, see [Get started with Windows Azure HDInsight][hdinsight-getting-started].
- A computer that is running Windows 8, Windows 7, Windows Server 2012, or Windows Server 2008 R2.
- Office 2013 Professional Plus, Office 365 Pro Plus, Excel 2013 Standalone, or Office 2010 Professional Plus.

## In this article

- [Install Microsoft Power Query for Excel](#InstallPowerQuery)
- [Import data into Excel](#ImportData)
- [Next steps](#NextSteps)


## <a id="InstallPowerQuery"></a>Install Microsoft Power Query for Excel

Power Query can be used to import data from a variety of sources into Microsoft Excel, where it can power Business Intelligence (BI) tools like PowerPivot and Power View. In particular, Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster. 


**To install Microsoft Power Query for Excel**

- Download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.

## <a id="ImportData"></a>Import HDInsight data into Excel

The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel where business intelligence tools such as PowerPivot and Power Map may be used to inspect, analyze, and present the data.

**To import data from an HDInsight cluster**

1. Open Excel.

2. Create a new blank workbook.

3. Click the **Power Query** menu, click **From Other Sources**, and then click **From Windows Azure HDInsight**. 

	![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]

	Note: If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Addins** from the drop-down **Manager** box at the bottom of the page. Select the **Go...** button and verify that the box for the Microsoft Office Power Query for Excel Add-In has been checked.

3. Enter the **Account Name** of the Windows Azure Blob storage account associated with your cluster, and then click **OK**. 

4. Enter the **Account Key** for the Blob storage account, and then click **Save**. (You need to do this only the first time you access this store.)	

5. In the **Navigator** pane on the left of the **Query Editor**, click the Blob storage container name. By default the container name is the same name as the cluster name. 

6. Locate **HiveSampleData.txt** in the **Name** column, and then click **Binary** in the same row.

	![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]

6. Right-click **Column1**, point to **Split Column**, and then click **By Delimiter**.

7. Select **Tab** in **Select or enter delimiter**, and **At each occurrence of the delimiter**, and then click **OK**.
9. Click **Done**. The query then imports the data file into Excel.

	![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a id="NextSteps"></a>Next steps

In this article you learned how to use Power Query to retrieve data from HDInsight into Excel. Similarly, you can retrieve data from HDInsight into SQL Azure. It is also possible to upload data into HDInsight. To learn more, see the following articles:

* [Upload Data to HDInsight][upload-data].
* [Use HDInsight to process Blob storage data and write the results to a SQL Database][blob-hdi-sql]. 


[azure-purchase-options]: https://www.windowsazure.com/en-us/pricing/purchase-options/
[azure-member-offers]: https://www.windowsazure.com/en-us/pricing/member-offers/
[azure-free-trial]: https://www.windowsazure.com/en-us/pricing/free-trial/
[azure-management-portal]: https://manage.windowsazure.com/


[hdinsight-getting-started]: /en-us/manage/services/hdinsight/get-started-hdinsight/
[blob-hdi-sql]: /en-us/manage/services/hdinsight/process-blob-data-and-write-to-sql/
[upload-data]: /en-us/manage/services/hdinsight/howto-upload-data-to-hdinsight/

[image-hdi-powerquery-hdi-source]: ../media/HDI.PowerQuery.SelectHdiSource.png
[image-hdi-powerquery-importdata]: ../media/HDI.PowerQuery.ImportData.png
[image-hdi-powerquery-imported-table]: ../media/HDI.PowerQuery.ImportedTable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689 
