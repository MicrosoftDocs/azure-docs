---
author: DCtheGeek
ms.service: azure-policy
ms.topic: include
ms.date: 02/10/2020
ms.author: dacoulte
---

|Name |Description |Effect(s) |Version |
|---|---|---|---|
|[\[Preview\]: Audit Dependency Agent Deployment - VM Image (OS) unlisted](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DependencyAgent_OSImage_Audit.json) |Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. |auditIfNotExists |1.0.0-preview |
|[\[Preview\]: Audit Dependency Agent Deployment in VMSS - VM Image (OS) unlisted](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DependencyAgent_OSImage_VMSS_Audit.json) |Reports VMSS as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. |auditIfNotExists |1.0.0-preview |
|[\[Preview\]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalytics_OSImage_Audit.json) |Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. |auditIfNotExists |1.0.0-preview |
|[\[Preview\]: Audit Log Analytics Agent Deployment in VMSS - VM Image (OS) unlisted](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalytics_OSImage_VMSS_Audit.json) |Reports VMSS as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. |auditIfNotExists |1.0.0-preview |
|[\[Preview\]: Audit Log Analytics Workspace for VM - Report Mismatch](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalytics_WorkspaceMismatch_VM_Audit.json) |Reports VMs as non-compliant if they not logging to the LA workspace specified in the policy/initiative assignment. |audit |1.0.0-preview |
|[\[Preview\]: Deploy Dependency Agent for Linux VM Scale Sets (VMSS)](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DependencyAgentExtension_Linux_VMSS_Deploy.json) |Deploy Dependency Agent for Linux VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Dependency Agent for Linux VMs](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DependencyAgentExtension_Linux_VM_Deploy.json) |Deploy Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Dependency Agent for Windows VM Scale Sets (VMSS)](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DependencyAgentExtension_Windows_VMSS_Deploy.json) |Deploy Dependency Agent for Windows VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Dependency Agent for Windows VMs](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DependencyAgentExtension_Windows_VM_Deploy.json) |Deploy Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Log Analytics Agent for Linux VM Scale Sets (VMSS)](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalyticsExtension_Linux_VMSS_Deploy.json) |Deploy Log Analytics Agent for Linux VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Log Analytics Agent for Linux VMs](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalyticsExtension_Linux_VM_Deploy.json) |Deploy Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Log Analytics Agent for Windows VM Scale Sets (VMSS)](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalyticsExtension_Windows_VMSS_Deploy.json) |Deploy Log Analytics Agent for Windows VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. |deployIfNotExists |1.0.0-preview |
|[\[Preview\]: Deploy Log Analytics Agent for Windows VMs](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogAnalyticsExtension_Windows_VM_Deploy.json) |Deploy Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. |deployIfNotExists |1.0.0-preview |
|[Activity log should be retained for at least one year](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLogRetention_365orGreater.json) |This policy audits the activity log if the retention is not set for 365 days or forever (retention days set to 0). |AuditIfNotExists, Disabled |1.0.0 |
|[An activity log alert should exist for specific Administrative operations](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLog_AdministrativeOperations_Audit.json) |This policy audits specific Administrative operations with no activity log alerts configured. |AuditIfNotExists, Disabled |1.0.0 |
|[An activity log alert should exist for specific Policy operations](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLog_PolicyOperations_Audit.json) |This policy audits specific Policy operations with no activity log alerts configured. |AuditIfNotExists, Disabled |1.0.0 |
|[An activity log alert should exist for specific Security operations](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLog_SecurityOperations_Audit.json) |This policy audits specific Security operations with no activity log alerts configured. |AuditIfNotExists, Disabled |1.0.0 |
|[Audit diagnostic setting](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DiagnosticSettingsForTypes_Audit.json) |Audit diagnostic setting for selected resource types |AuditIfNotExists |1.0.0 |
|[Azure Monitor log profile should collect logs for categories 'write,' 'delete,' and 'action'](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLog_CaptureAllCategories.json) |This policy ensures that a log profile collects logs for categories 'write,' 'delete,' and 'action' |AuditIfNotExists, Disabled |1.0.0 |
|[Azure Monitor should collect activity logs from all regions](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLog_CaptureAllRegions.json) |This policy audits the Azure Monitor log profile which does not export activities from all Azure supported regions including global. |AuditIfNotExists, Disabled |1.0.0 |
|[Azure Monitor solution 'Security and Audit' must be deployed](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/Security_Audit_MustBeDeployed.json) |This policy ensures that Security and Audit is deployed. |AuditIfNotExists, Disabled |1.0.0 |
|[Azure subscriptions should have a log profile for Activity Log](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/Logprofile_activityLogs_Audit.json) |This policy ensures if a log profile is enabled for exporting activity logs. It audits if there is no log profile created to export the logs either to a storage account or to an event hub. |AuditIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Batch Account to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/Batch_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Batch Account to stream to a regional Event Hub when any Batch Account which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Batch Account to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/Batch_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Batch Account to stream to a regional Log Analytics workspace when any Batch Account which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Data Lake Analytics to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DataLakeAnalytics_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Event Hub when any Data Lake Analytics which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DataLakeAnalytics_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Data Lake Storage Gen1 to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DataLakeStorage_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Data Lake Storage Gen1 to stream to a regional Event Hub when any Data Lake Storage Gen1 which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Data Lake Storage Gen1 to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DataLakeStorage_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Data Lake Storage Gen1 to stream to a regional Log Analytics workspace when any Data Lake Storage Gen1 which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Event Hub to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/EventHub_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Event Hub to stream to a regional Event Hub when any Event Hub which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Event Hub to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/EventHub_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Key Vault to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/KeyVault_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Key Vault to stream to a regional Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Logic Apps to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogicApps_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Logic Apps to stream to a regional Event Hub when any Logic Apps which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Logic Apps to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/LogicApps_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Logic Apps to stream to a regional Log Analytics workspace when any Logic Apps which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Network Security Groups](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/DiagnosticSettingsForNSG_Deploy.json) |This policy automatically deploys diagnostic settings to network security groups. A storage account with name '{storagePrefixParameter}{NSGLocation}' will be automatically created. |deployIfNotExists |1.0.0 |
|[Deploy Diagnostic Settings for Search Services to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/Search_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Search Services to stream to a regional Event Hub when any Search Services which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Search Services to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/Search_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Service Bus to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ServiceBus_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Service Bus to stream to a regional Event Hub when any Service Bus which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Service Bus to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ServiceBus_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Stream Analytics to Event Hub](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/StreamAnalytics_DeployDiagnosticLog_Deploy_EventHub.json) |Deploys the diagnostic settings for Stream Analytics to stream to a regional Event Hub when any Stream Analytics which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/StreamAnalytics_DeployDiagnosticLog_Deploy_LogAnalytics.json) |Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. |DeployIfNotExists, Disabled |1.0.0 |
|[Storage account containing the container with activity logs must be encrypted with BYOK](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/ActivityLog_StorageAccountBYOK_Audit.json) |This policy audits if the Storage account containing the container with activity logs is encrypted with BYOK. The policy works only if the storage account lies on the same subscription as activity logs by design. More information on Azure Storage encryption at rest can be found here https://aka.ms/azurestoragebyok.  |AuditIfNotExists, Disabled |1.0.0 |
|[The Log Analytics agent should be installed on Virtual Machine Scale Sets](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/VMSS_LogAnalyticsAgent_AuditIfNotExists.json) |This policy audits any Windows/Linux Virtual Machine Scale Sets if the Log Analytics agent is not installed. |AuditIfNotExists, Disabled |1.0.0 |
|[The Log Analytics agent should be installed on virtual machines](https://github.com/Azure/azure-policy/blob/masterbuilt-in-policies/policyDefinitions/Monitoring/VirtualMachines_LogAnalyticsAgent_AuditIfNotExists.json) |This policy audits any Windows/Linux virtual machines if the Log Analytics agent is not installed. |AuditIfNotExists, Disabled |1.0.0 |
