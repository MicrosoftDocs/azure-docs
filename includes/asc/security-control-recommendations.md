---
author: memildin
ms.service: defender-for-cloud
ms.topic: include
ms.date: 08/22/2023
ms.author: memildin
ms.custom: generated
---

<table class="tg">
<thead>
  <tr>
    <th class="tg-cly1"><b>Secure score</b></th>
    <th class="tg-cly1"><b>Security control and description</b></th>
    <th class="tg-cly1"><b>Recommendations</b></th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-lboi"><strong>10</strong></td>
    <td class="tg-lboi"><strong>Enable MFA</strong> - Defender for Cloud places a high value on multi-factor authentication (MFA). Use these recommendations to secure the users of your subscriptions. <br>There are three ways to enable MFA and be compliant with the recommendations: security defaults, per-user assignment, conditional access policy. Learn more about these options in <a href="/azure/defender-for-cloud/multi-factor-authentication-enforcement">Manage MFA enforcement on your subscriptions</a>.</td>
    <td class="tg-lboi" width=55%>- Accounts with owner permissions on Azure resources should be MFA enabled<br />- Accounts with write permissions on Azure resources should be MFA enabled
  </tr>
  <tr>
    <td class="tg-lboi"><strong>8</strong></td>
    <td class="tg-lboi"><strong>Secure management ports</strong> - Brute force attacks often target management ports. Use these recommendations to reduce your exposure with tools like <a href="/azure/defender-for-cloud/just-in-time-access-overview">just-in-time VM access</a> and <a href="/azure/virtual-network/network-security-groups-overview">network security groups</a>.</td>
    <td class="tg-lboi" width=55%>- Internet-facing virtual machines should be protected with network security groups<br />- Management ports of virtual machines should be protected with just-in-time network access control<br />- Management ports should be closed on your virtual machines</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>6</strong></td>
    <td class="tg-lboi"><strong>Apply system updates</strong> - Not applying updates leaves unpatched vulnerabilities and results in environments that are susceptible to attacks. Use these recommendations to maintain operational efficiency, reduce security vulnerabilities, and provide a more stable environment for your end users. To deploy system updates, you can use the <a href="/azure/automation/update-management/overview">Update Management solution to manage patches and updates</a> for your machines.</td>
    <td class="tg-lboi" width=55%>- Log Analytics agent should be installed on Linux-based Azure Arc-enabled machines<br />- Log Analytics agent should be installed on virtual machine scale sets<br />- Log Analytics agent should be installed on virtual machines<br />- Log Analytics agent should be installed on Windows-based Azure Arc-enabled machines<br />- System updates on virtual machine scale sets should be installed<br />- System updates should be installed on your machines<br />- System updates should be installed on your machines (powered by Update Center)</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>6</strong></td>
    <td class="tg-lboi"><strong>Remediate vulnerabilities</strong> - Defender for Cloud includes multiple vulnerability assessment scanners to check your machines, databases, and container registries for weaknesses that threat actors might leverage. Use these recommendations to enable these scanners and review their findings.<br>Learn more about scanning <a href="/azure/defender-for-cloud/deploy-vulnerability-assessment-vm">machines</a>, <a href="/azure/defender-for-cloud/defender-for-sql-on-machines-vulnerability-assessment">SQL servers</a>, and <a href="/azure/defender-for-cloud/defender-for-container-registries-usage">container registries</a>.</td>
    <td class="tg-lboi" width=55%>- Azure Arc-enabled Kubernetes clusters should have the Azure Policy extension installed<br />- Azure Kubernetes Service clusters should have the Azure Policy add-on for Kubernetes installed<br />- Code repositories should have code scanning findings resolved<br />- Code repositories should have Dependabot scanning findings resolved<br />- Code repositories should have infrastructure as code scanning findings resolved<br />- Code repositories should have secret scanning findings resolved<br />- Container images should be deployed from trusted registries only<br />- Container registry images should have vulnerability findings resolved<br />- Function apps should have vulnerability findings resolved<br />- Kubernetes clusters should gate deployment of vulnerable images<br />- Machines should have a vulnerability assessment solution<br />- Machines should have vulnerability findings resolved<br />- Running container images should have vulnerability findings resolved</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>4</strong></td>
    <td class="tg-lboi"><strong>Remediate security configurations</strong> - Misconfigured IT assets have a higher risk of being attacked. Use these recommendations to harden the identified misconfigurations across your infrastructure.</td>
    <td class="tg-lboi" width=55%>- Azure Arc-enabled Kubernetes clusters should have the Azure Policy extension installed<br />- Azure DevOps security posture findings should be resolved<br />- Azure Kubernetes Service clusters should have the Azure Policy add-on for Kubernetes installed<br />- Containers should only use allowed AppArmor profiles<br />- Log Analytics agent should be installed on Linux-based Azure Arc-enabled machines<br />- Log Analytics agent should be installed on virtual machine scale sets<br />- Log Analytics agent should be installed on virtual machines<br />- Log Analytics agent should be installed on Windows-based Azure Arc-enabled machines<br />- Machines should be configured securely<br />- SQL databases should have vulnerability findings resolved<br />- SQL managed instances should have vulnerability assessment configured<br />- SQL servers on machines should have vulnerability findings resolved<br />- SQL servers should have vulnerability assessment configured<br />- Virtual machine scale sets should be configured securely<br />- Vulnerabilities in security configuration on your Linux machines should be remediated (powered by Guest Configuration)<br />- Vulnerabilities in security configuration on your Windows machines should be remediated (powered by Guest Configuration)</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>4</strong></td>
    <td class="tg-lboi"><strong>Manage access and permissions</strong> - A core part of a security program is ensuring your users have the necessary access to do their jobs but no more than that: the least privilege access model. Use these recommendations to manage your identity and access requirements.</td>
    <td class="tg-lboi" width=55%>- Authentication to Linux machines should require SSH keys<br />- Azure Arc-enabled Kubernetes clusters should have the Azure Policy extension installed<br />- Azure Cosmos DB accounts should use Azure Active Directory as the only authentication method<br />- Azure Kubernetes Service clusters should have the Azure Policy add-on for Kubernetes installed<br />- Blocked accounts with owner permissions on Azure resources should be removed<br />- Blocked accounts with read and write permissions on Azure resources should be remove<br />- Container with privilege escalation should be avoided<br />- Containers sharing sensitive host namespaces should be avoided<br />- Deprecated accounts should be removed from subscriptions<br />- Deprecated accounts with owner permissions should be removed from subscriptions<br />- External accounts with owner permissions should be removed from subscriptions<br />- External accounts with write permissions should be removed from subscriptions<br />- Function apps should have Client Certificates (Incoming client certificates) enabled<br />- Guest accounts with owner permissions on Azure resources should be removed<br />- Guest accounts with write permissions on Azure resources should be removed<br />- Guest Configuration extension should be installed on machines<br />- Immutable (read-only) root filesystem should be enforced for containers<br />- Least privileged Linux capabilities should be enforced for containers<br />- Managed identity should be used in API apps<br />- Managed identity should be used in function apps<br />- Managed identity should be used in web apps<br />- Privileged containers should be avoided<br />- Role-Based Access Control should be used on Kubernetes Services<br />- Running containers as root user should be avoided<br />- Service Fabric clusters should only use Azure Active Directory for client authentication<br />- Storage account public access should be disallowed<br />- Usage of pod HostPath volume mounts should be restricted to a known list to restrict node access from compromised containers<br />- Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>4</strong></td>
    <td class="tg-lboi"><strong>Enable encryption at rest</strong> - Use these recommendations to ensure you mitigate misconfigurations around the protection of your stored data.</td>
    <td class="tg-lboi" width=55%>- Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign<br />- Transparent Data Encryption on SQL databases should be enabled<br />- Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>4</strong></td>
    <td class="tg-lboi"><strong>Encrypt data in transit</strong> - Use these recommendations to secure data that’s moving between components, locations, or programs. Such data is susceptible to man-in-the-middle attacks, eavesdropping, and session hijacking.</td>
    <td class="tg-lboi" width=55%>- API App should only be accessible over HTTPS<br />- Enforce SSL connection should be enabled for MySQL database servers<br />- Enforce SSL connection should be enabled for PostgreSQL database servers<br />- FTPS should be required in API apps<br />- FTPS should be required in function apps<br />- FTPS should be required in web apps<br />- Function App should only be accessible over HTTPS<br />- Redis Cache should allow access only via SSL<br />- Secure transfer to storage accounts should be enabled<br />- TLS should be updated to the latest version for API apps<br />- TLS should be updated to the latest version for function apps<br />- TLS should be updated to the latest version for web apps<br />- Web Application should only be accessible over HTTPS</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>4</strong></td>
    <td class="tg-lboi"><strong>Restrict unauthorized network access</strong> - Azure offers a suite of tools designed to ensure accesses across your network meet the highest security standards.<br>Use these recommendations to manage <a href="/azure/defender-for-cloud/adaptive-network-hardening">Defender for Cloud's adaptive network hardening</a> settings, ensure you’ve configured <a href="/azure/private-link/private-link-overview">Azure Private Link</a> for all relevant PaaS services, enable <a href="/azure/firewall/overview">Azure Firewall</a> on your virtual networks, and more.</td>
    <td class="tg-lboi" width=55%>- Adaptive network hardening recommendations should be applied on internet facing virtual machines<br />- All network ports should be restricted on network security groups associated to your virtual machine<br />- App Configuration should use private link<br />- Azure Arc-enabled Kubernetes clusters should have the Azure Policy extension installed<br />- Azure Cache for Redis should reside within a virtual network<br />- Azure Event Grid domains should use private link<br />- Azure Event Grid topics should use private link<br />- Azure Kubernetes Service clusters should have the Azure Policy add-on for Kubernetes installed<br />- Azure Machine Learning workspaces should use private link<br />- Azure SignalR Service should use private link<br />- Azure Spring Cloud should use network injection<br />- Container registries should not allow unrestricted network access<br />- Container registries should use private link<br />- CORS should not allow every resource to access API Apps<br />- CORS should not allow every resource to access Function Apps<br />- CORS should not allow every resource to access Web Applications<br />- Firewall should be enabled on Key Vault<br />- Internet-facing virtual machines should be protected with network security groups<br />- IP forwarding on your virtual machine should be disabled<br />- Kubernetes API server should be configured with restricted access<br />- Private endpoint should be configured for Key Vault<br />- Private endpoint should be enabled for MariaDB servers<br />- Private endpoint should be enabled for MySQL servers<br />- Private endpoint should be enabled for PostgreSQL servers<br />- Public network access should be disabled for MariaDB servers<br />- Public network access should be disabled for MySQL servers<br />- Public network access should be disabled for PostgreSQL servers<br />- Services should listen on allowed ports only<br />- Storage account should use a private link connection<br />- Storage accounts should restrict network access using virtual network rules<br />- Usage of host networking and ports should be restricted<br />- Virtual networks should be protected by Azure Firewall<br />- VM Image Builder templates should use private link</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>3</strong></td>
    <td class="tg-lboi"><strong>Apply adaptive application control</strong> - Adaptive application control is an intelligent, automated, end-to-end solution to control which applications can run on your machines. It also helps to harden your machines against malware.</td>
    <td class="tg-lboi" width=55%>- Adaptive application controls for defining safe applications should be enabled on your machines<br />- Allowlist rules in your adaptive application control policy should be updated<br />- Log Analytics agent should be installed on Linux-based Azure Arc-enabled machines<br />- Log Analytics agent should be installed on virtual machines<br />- Log Analytics agent should be installed on Windows-based Azure Arc-enabled machines</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>2</strong></td>
    <td class="tg-lboi"><strong>Protect applications against DDoS attacks</strong> - Azure’s advanced networking security solutions include Azure DDoS Protection, Azure Web Application Firewall, and the Azure Policy Add-on for Kubernetes. Use these recommendations to ensure your applications are protected with these tools and others. </td>    
    <td class="tg-lboi" width=55%>- Azure Arc-enabled Kubernetes clusters should have the Azure Policy extension installed<br />- Azure DDoS Protection Standard should be enabled<br />- Azure Kubernetes Service clusters should have the Azure Policy add-on for Kubernetes installed<br />- Container CPU and memory limits should be enforced<br />- Web Application Firewall (WAF) should be enabled for Application Gateway<br />- Web Application Firewall (WAF) should be enabled for Azure Front Door Service service</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>2</strong></td>
    <td class="tg-lboi"><strong>Enable endpoint protection</strong> - Defender for Cloud checks your organization’s endpoints for active threat detection and response solutions such as Microsoft Defender for Endpoint or any of the major solutions shown in <a href="/azure/defender-for-cloud/supported-machines-endpoint-solutions-clouds?tabs=features-windows#supported-endpoint-protection-solutions-">this list</a>.<br>When an Endpoint Detection and Response (EDR) solution isn’t found, you can use these recommendations to deploy Microsoft Defender for Endpoint (included as part of <a href="/azure/defender-for-cloud/defender-for-servers-introduction">Microsoft Defender for servers</a>).<br>Other recommendations in this control help you deploy the Log Analytics agent and configure <a href="/azure/defender-for-cloud/file-integrity-monitoring-overview">file integrity monitoring</a>.</td>
    <td class="tg-lboi" width=55%>- Endpoint protection health issues on machines should be resolved<br />- Endpoint protection health issues on machines should be resolved<br />- Endpoint protection health issues on virtual machine scale sets should be resolved<br />- Endpoint protection should be installed on machines<br />- Endpoint protection should be installed on machines<br />- Endpoint protection should be installed on virtual machine scale sets<br />- Install endpoint protection solution on virtual machines<br />- Log Analytics agent should be installed on Linux-based Azure Arc-enabled machines<br />- Log Analytics agent should be installed on virtual machine scale sets<br />- Log Analytics agent should be installed on virtual machines<br />- Log Analytics agent should be installed on Windows-based Azure Arc-enabled machines</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>1</strong></td>
    <td class="tg-lboi"><strong>Enable auditing and logging</strong> - Detailed logs are a crucial part of incident investigations and many other troubleshooting operations. The recommendations in this control focus on ensuring you’ve enabled diagnostic logs wherever relevant.</td>
    <td class="tg-lboi" width=55%>- Auditing on SQL server should be enabled<br />- Diagnostic logs in App Service should be enabled<br />- Diagnostic logs in Azure Data Lake Store should be enabled<br />- Diagnostic logs in Azure Stream Analytics should be enabled<br />- Diagnostic logs in Batch accounts should be enabled<br />- Diagnostic logs in Data Lake Analytics should be enabled<br />- Diagnostic logs in Event Hub should be enabled<br />- Diagnostic logs in Key Vault should be enabled<br />- Diagnostic logs in Kubernetes services should be enabled<br />- Diagnostic logs in Logic Apps should be enabled<br />- Diagnostic logs in Search services should be enabled<br />- Diagnostic logs in Service Bus should be enabled<br />- Diagnostic logs in Virtual Machine Scale Sets should be enabled</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>0</strong></td>
    <td class="tg-lboi"><strong>Enable enhanced security features</strong> - Use these recommendations to enable any of the <a href="/azure/defender-for-cloud/enhanced-security-features-overview">enhanced security features plans</a>.</td>
    <td class="tg-lboi" width=55%>- Azure Arc-enabled Kubernetes clusters should have the Defender extension installed<br />- Azure Kubernetes Service clusters should have Defender profile enabled<br />- File integrity monitoring should be enabled on machines<br />- GitHub repositories should have Code scanning enabled<br />- GitHub repositories should have Dependabot scanning enabled<br />- GitHub repositories should have Secret scanning enabled<br />- Microsoft Defender for App Service should be enabled<br />- Microsoft Defender for Azure SQL Database servers should be enabled<br />- Microsoft Defender for Containers should be enabled<br />- Microsoft Defender for DNS should be enabled<br />- Microsoft Defender for Key Vault should be enabled<br />- Microsoft Defender for open-source relational databases should be enabled<br />- Microsoft Defender for Resource Manager should be enabled<br />- Microsoft Defender for servers should be enabled<br />- Microsoft Defender for servers should be enabled on workspaces<br />- Microsoft Defender for SQL on machines should be enabled on workspaces<br />- Microsoft Defender for SQL servers on machines should be enabled<br />- Microsoft Defender for Storage should be enabled</td>
  </tr>
  <tr>
    <td class="tg-lboi"><strong>0</strong></td>
    <td class="tg-lboi"><strong>Implement security best practices</strong> - This control has no impact on your secure score. For that reason, it’s a collection of recommendations which are important to fulfil for the sake of your organization’s security, but which we feel shouldn’t be a part of how you assess your overall score.</td>
    <td class="tg-lboi" width=55%>- [Enable if required] Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest<br />- [Enable if required] Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)<br />- [Enable if required] Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)<br />- [Enable if required] Container registries should be encrypted with a customer-managed key (CMK)<br />- [Enable if required] MySQL servers should use customer-managed keys to encrypt data at rest<br />- [Enable if required] PostgreSQL servers should use customer-managed keys to encrypt data at rest<br />- [Enable if required] SQL managed instances should use customer-managed keys to encrypt data at rest<br />- [Enable if required] SQL servers should use customer-managed keys to encrypt data at rest<br />- [Enable if required] Storage accounts should use customer-managed key (CMK) for encryption<br />- A maximum of 3 owners should be designated for subscriptions<br />- Access to storage accounts with firewall and virtual network configurations should be restricted<br />- Accounts with read permissions on Azure resources should be MFA enabled<br />- All advanced threat protection types should be enabled in SQL managed instance advanced data security settings<br />- All advanced threat protection types should be enabled in SQL server advanced data security settings<br />- API Management services should use a virtual network<br />- Audit retention for SQL servers should be set to at least 90 days<br />- Auto provisioning of the Log Analytics agent should be enabled on subscriptions<br />- Automation account variables should be encrypted<br />- Azure Backup should be enabled for virtual machines<br />- Azure Cosmos DB accounts should have firewall rules<br />- Cognitive Services accounts should enable data encryption<br />- Cognitive Services accounts should restrict network access<br />- Cognitive Services accounts should use customer owned storage or enable data encryption<br />- Container hosts should be configured securely<br />- Default IP Filter Policy should be Deny<br />- Diagnostic logs in IoT Hub should be enabled<br />- Email notification for high severity alerts should be enabled<br />- Email notification to subscription owner for high severity alerts should be enabled<br />- Ensure API app has Client Certificates Incoming client certificates set to On<br />- External accounts with read permissions should be removed from subscriptions<br />- Geo-redundant backup should be enabled for Azure Database for MariaDB<br />- Geo-redundant backup should be enabled for Azure Database for MySQL<br />- Geo-redundant backup should be enabled for Azure Database for PostgreSQL<br />- Guest accounts with read permissions on Azure resources should be removed<br />- Guest Attestation extension should be installed on supported Linux virtual machine scale sets<br />- Guest Attestation extension should be installed on supported Linux virtual machines<br />- Guest Attestation extension should be installed on supported Windows virtual machine scale sets<br />- Guest Attestation extension should be installed on supported Windows virtual machines<br />- Guest Configuration extension should be installed on machines<br />- Identical Authentication Credentials<br />- IP Filter rule large IP range<br />- Java should be updated to the latest version for API apps<br />- Java should be updated to the latest version for function apps<br />- Java should be updated to the latest version for web apps<br />- Key Vault keys should have an expiration date<br />- Key Vault secrets should have an expiration date<br />- Key vaults should have purge protection enabled<br />- Key vaults should have soft delete enabled<br />- Kubernetes clusters should be accessible only over HTTPS<br />- Kubernetes clusters should disable automounting API credentials<br />- Kubernetes clusters should not grant CAPSYSADMIN security capabilities<br />- Kubernetes clusters should not use the default namespace<br />- Linux virtual machines should enforce kernel module signature validation<br />- Linux virtual machines should use only signed and trusted boot components<br />- Linux virtual machines should use Secure Boot<br />- Machines should be restarted to apply security configuration updates<br />- Machines should have ports closed that might expose attack vectors<br />- Microsoft Defender for SQL should be enabled for unprotected Azure SQL servers<br />- Microsoft Defender for SQL should be enabled for unprotected SQL Managed Instances<br />- Network Watcher should be enabled<br />- Non-internet-facing virtual machines should be protected with network security groups<br />- Over-provisioned identities in subscriptions should be investigated to reduce the Permission Creep Index (PCI)<br />- PHP should be updated to the latest version for API apps<br />- PHP should be updated to the latest version for web apps<br />- Private endpoint connections on Azure SQL Database should be enabled<br />- Public network access on Azure SQL Database should be disabled<br />- Public network access should be disabled for Cognitive Services accounts<br />- Python should be updated to the latest version for API apps<br />- Python should be updated to the latest version for function apps<br />- Python should be updated to the latest version for web apps<br />- Remote debugging should be turned off for API App<br />- Remote debugging should be turned off for Function App<br />- Remote debugging should be turned off for Web Applications<br />- Secure Boot should be enabled on supported Windows virtual machines<br />- SQL servers should have an Azure Active Directory administrator provisioned<br />- Storage accounts should be migrated to new Azure Resource Manager resources<br />- Subnets should be associated with a network security group<br />- Subscriptions should have a contact email address for security issues<br />- There should be more than one owner assigned to subscriptions<br />- Validity period of certificates stored in Azure Key Vault should not exceed 12 months<br />- Virtual machines guest attestation status should be healthy<br />- Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity<br />- Virtual machines should be migrated to new Azure Resource Manager resources<br />- vTPM should be enabled on supported virtual machines<br />- Web apps should request an SSL certificate for all incoming requests<br />- Windows Defender Exploit Guard should be enabled on machines<br />- Windows web servers should be configured to use secure communication protocols</td>
  </tr>
</tbody>
</table>
