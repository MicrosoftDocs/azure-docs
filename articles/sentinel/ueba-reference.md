---
title: Microsoft Sentinel UEBA reference | Microsoft Docs
description: This article displays the entity enrichments generated by Microsoft Sentinel's entity behavior analytics.
author: yelevin
ms.topic: reference
ms.date: 06/28/2022
ms.author: yelevin
ms.custom: ignite-fall-2021
---

# Microsoft Sentinel UEBA reference

This reference article lists the input data sources for the User and Entity Behavior Analytics service in Microsoft Sentinel. It also describes the enrichments that UEBA adds to entities, providing needed context to alerts and incidents.

## UEBA data sources

These are the data sources from which the UEBA engine collects and analyzes data to train its ML models and set behavioral baselines for users, devices, and other entities. UEBA then looks at data from these sources to find anomalies and glean insights.

| Data source | Events |
| ----------- | ------ |
| **Microsoft Entra ID**<br>Sign-in logs | All |
| **Microsoft Entra ID**<br>Audit logs | ApplicationManagement<br>DirectoryManagement<br>GroupManagement<br>Device<br>RoleManagement<br>UserManagementCategory |
| **Azure Activity logs** | Authorization<br>AzureActiveDirectory<br>Billing<br>Compute<br>Consumption<br>KeyVault<br>Devices<br>Network<br>Resources<br>Intune<br>Logic<br>Sql<br>Storage |
| **Windows Security events**<br>*WindowsEvent* or<br>*SecurityEvent* | 4624: An account was successfully logged on<br>4625: An account failed to log on<br>4648: A logon was attempted using explicit credentials<br>4672: Special privileges assigned to new logon<br>4688: A new process has been created |

## UEBA enrichments

This section describes the enrichments UEBA adds to Microsoft Sentinel entities, along with all their details, that you can use to focus and sharpen your security incident investigations. These enrichments are displayed on [entity pages](entity-pages.md#how-to-use-entity-pages) and can be found in the following Log Analytics tables, the contents and schema of which are listed below:

- The **BehaviorAnalytics** table is where UEBA's output information is stored.

    The following three dynamic fields from the BehaviorAnalytics table are described in the [entity enrichments dynamic fields](#entity-enrichments-dynamic-fields) section below.

    - The [UsersInsights](#usersinsights-field) and  [DevicesInsights](#devicesinsights-field) fields contain entity information from Active Directory / Microsoft Entra ID and Microsoft Threat Intelligence sources.

    - The [ActivityInsights](#activityinsights-field) field contains entity information based on the behavioral profiles built by Microsoft Sentinel's entity behavior analytics. 

        <a name="baseline-explained"></a>User activities are analyzed against a baseline that is dynamically compiled each time it is used. Each activity has its defined lookback period from which the dynamic baseline is derived. The lookback period is specified in the [**Baseline**](#activityinsights-field) column in this table.

- The **IdentityInfo** table is where identity information synchronized to UEBA from Microsoft Entra ID (and from on-premises Active Directory via Microsoft Defender for Identity) is stored.

### BehaviorAnalytics table

The following table describes the behavior analytics data displayed on each [entity details page](entity-pages.md#how-to-use-entity-pages) in Microsoft Sentinel.

| Field                     | Type     | Description                                                     |
| ------------------------- | -------- | --------------------------------------------------------------- |
| **TenantId**              | string   | The unique ID number of the tenant.                             |
| **SourceRecordId**        | string   | The unique ID number of the EBA event.                          |
| **TimeGenerated**         | datetime | The timestamp of the activity's occurrence.                     |
| **TimeProcessed**         | datetime | The timestamp of the activity's processing by the EBA engine.   |
| **ActivityType**          | string   | The high-level category of the activity.                        |
| **ActionType**            | string   | The normalized name of the activity.                            |
| **UserName**              | string   | The username of the user that initiated the activity.           |
| **UserPrincipalName**     | string   | The full username of the user that initiated the activity.      |
| **EventSource**           | string   | The data source that provided the original event.               |
| **SourceIPAddress**       | string   | The IP address from which activity was initiated.               |
| **SourceIPLocation**      | string   | The country from which activity was initiated, enriched from IP address. |
| **SourceDevice**          | string   | The hostname of the device that initiated the activity.         |
| **DestinationIPAddress**  | string   | The IP address of the target of the activity.                   |
| **DestinationIPLocation** | string   | The country of the target of the activity, enriched from IP address. |
| **DestinationDevice**     | string   | The name of the target device.                                  |
| **UsersInsights**         | dynamic  | The contextual enrichments of involved users ([details below](#usersinsights-field)). |
| **DevicesInsights**       | dynamic  | The contextual enrichments of involved devices ([details below](#devicesinsights-field)). |
| **ActivityInsights**      | dynamic  | The contextual analysis of activity based on our profiling ([details below](#activityinsights-field)). |
| **InvestigationPriority** | int      | The anomaly score, between 0-10 (0=benign, 10=highly anomalous). |



### Entity enrichments dynamic fields

> [!NOTE]
> The **Enrichment name** column in the tables in this section displays two rows of information. 
>
> - The first, in **bold**, is the "friendly name" of the enrichment.
> - The second *(in italics and parentheses)* is the field name of the enrichment as stored in the [**Behavior Analytics table**](#behavioranalytics-table).

#### UsersInsights field

The following table describes the enrichments featured in the **UsersInsights** dynamic field in the BehaviorAnalytics table:

| Enrichment name | Description | Sample value |
| --- | --- | --- |
| **Account display name**<br>*(AccountDisplayName)* | The account display name of the user. | Admin, Hayden Cook |
| **Account domain**<br>*(AccountDomain)* | The account domain name of the user. |  |
| **Account object ID**<br>*(AccountObjectID)* | The account object ID of the user. | a58df659-5cab-446c-9dd0-5a3af20ce1c2 |
| **Blast radius**<br>*(BlastRadius)* | The blast radius is calculated based on several factors: the position of the user in the org tree, and the user's Microsoft Entra roles and permissions. User must have *Manager* property populated in Microsoft Entra ID for *BlastRadius* to be calculated. | Low, Medium, High |
| **Is dormant account**<br>*(IsDormantAccount)* | The account has not been used for the past 180 days. | True, False |
| **Is local admin**<br>*(IsLocalAdmin)* | The account has local administrator privileges. | True, False |
| **Is new account**<br>*(IsNewAccount)* | The account was created within the past 30 days. | True, False |
| **On premises SID**<br>*(OnPremisesSID)* | The on-premises SID of the user related to the action. | S-1-5-21-1112946627-1321165628-2437342228-1103 |

#### DevicesInsights field

The following table describes the enrichments featured in the **DevicesInsights** dynamic field in the BehaviorAnalytics table:

| Enrichment name | Description | Sample value |
| --- | --- | --- |
| **Browser**<br>*(Browser)* | The browser used in the action. | Edge, Chrome |
| **Device family**<br>*(DeviceFamily)* | The device family used in the action. | Windows |
| **Device type**<br>*(DeviceType)* | The client device type used in the action | Desktop |
| **ISP**<br>*(ISP)* | The internet service provider used in the action. |  |
| **Operating system**<br>*(OperatingSystem)* | The operating system used in the action. | Windows 10 |
| **Threat intel indicator description**<br>*(ThreatIntelIndicatorDescription)* | Description of the observed threat indicator resolved from the IP address used in the action. | Host is member of botnet: azorult |
| **Threat intel indicator type**<br>*(ThreatIntelIndicatorType)* | The type of the threat indicator resolved from the IP address used in the action. | Botnet, C2, CryptoMining, Darknet, Ddos, MaliciousUrl, Malware, Phishing, Proxy, PUA, Watchlist |
| **User agent**<br>*(UserAgent)* | The user agent used in the action. | Microsoft Azure Graph Client Library 1.0,<br>​Swagger-Codegen/1.4.0.0/csharp,<br>EvoSTS |
| **User agent family**<br>*(UserAgentFamily)* | The user agent family used in the action. | Chrome, Edge, Firefox |

#### ActivityInsights field

The following tables describe the enrichments featured in the **ActivityInsights** dynamic field in the BehaviorAnalytics table:

##### Action performed

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user performed action**<br>*(FirstTimeUserPerformedAction)* | 180 | The action was performed for the first time by the user. | True, False |
| **Action uncommonly performed by user**<br>*(ActionUncommonlyPerformedByUser)* | 10 | The action is not commonly performed by the user. | True, False |
| **Action uncommonly performed among peers**<br>*(ActionUncommonlyPerformedAmongPeers)* | 180 | The action is not commonly performed among user's peers. | True, False |
| **First time action performed in tenant**<br>*(FirstTimeActionPerformedInTenant)* | 180 | The action was performed for the first time by anyone in the organization. | True, False |
| **Action uncommonly performed in tenant**<br>*(ActionUncommonlyPerformedInTenant)* | 180 | The action is not commonly performed in the organization. | True, False |

##### App used

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user used app**<br>*(FirstTimeUserUsedApp)* | 180 | The app was used for the first time by the user. | True, False |
| **App uncommonly used by user**<br>*(AppUncommonlyUsedByUser)* | 10 | The app is not commonly used by the user. | True, False |
| **App uncommonly used among peers**<br>*(AppUncommonlyUsedAmongPeers)* | 180 | The app is not commonly used among user's peers. | True, False |
| **First time app observed in tenant**<br>*(FirstTimeAppObservedInTenant)* | 180 | The app was observed for the first time in the organization. | True, False |
| **App uncommonly used in tenant**<br>*(AppUncommonlyUsedInTenant)* | 180 | The app is not commonly used in the organization. | True, False |

##### Browser used

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user connected via browser**<br>*(FirstTimeUserConnectedViaBrowser)* | 30 | The browser was observed for the first time by the user. | True, False |
| **Browser uncommonly used by user**<br>*(BrowserUncommonlyUsedByUser)* | 10 | The browser is not commonly used by the user. | True, False |
| **Browser uncommonly used among peers**<br>*(BrowserUncommonlyUsedAmongPeers)* | 30 | The browser is not commonly used among user's peers. | True, False |
| **First time browser observed in tenant**<br>*(FirstTimeBrowserObservedInTenant)* | 30 | The browser was observed for the first time in the organization. | True, False |
| **Browser uncommonly used in tenant**<br>*(BrowserUncommonlyUsedInTenant)* | 30 | The browser is not commonly used in the organization. | True, False |

##### Country connected from

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user connected from country**<br>*(FirstTimeUserConnectedFromCountry)* | 90 | The geo location, as resolved from the IP address, was connected from for the first time by the user. | True, False |
| **Country uncommonly connected from by user**<br>*(CountryUncommonlyConnectedFromByUser)* | 10 | The geo location, as resolved from the IP address, is not commonly connected from by the user. | True, False |
| **Country uncommonly connected from among peers**<br>*(CountryUncommonlyConnectedFromAmongPeers)* | 90 | The geo location, as resolved from the IP address, is not commonly connected from among user's peers. | True, False |
| **First time connection from country observed in tenant**<br>*(FirstTimeConnectionFromCountryObservedInTenant)* | 90 | The country was connected from for the first time by anyone in the organization. | True, False |
| **Country uncommonly connected from in tenant**<br>*(CountryUncommonlyConnectedFromInTenant)* | 90 | The geo location, as resolved from the IP address, is not commonly connected from in the organization. | True, False |

##### Device used to connect

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user connected from device**<br>*(FirstTimeUserConnectedFromDevice)* | 30 | The source device was connected from for the first time by the user. | True, False |
| **Device uncommonly used by user**<br>*(DeviceUncommonlyUsedByUser)* | 10 | The device is not commonly used by the user. | True, False |
| **Device uncommonly used among peers**<br>*(DeviceUncommonlyUsedAmongPeers)* | 180 | The device is not commonly used among user's peers. | True, False |
| **First time device observed in tenant**<br>*(FirstTimeDeviceObservedInTenant)* | 30 | The device was observed for the first time in the organization. | True, False |
| **Device uncommonly used in tenant**<br>*(DeviceUncommonlyUsedInTenant)* | 180 | The device is not commonly used in the organization. | True, False |

##### Other device-related

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user logged on to device**<br>*(FirstTimeUserLoggedOnToDevice)* | 180 | The destination device was connected to for the first time by the user. | True, False |
| **Device family uncommonly used in tenant**<br>*(DeviceFamilyUncommonlyUsedInTenant)* | 30 | The device family is not commonly used in the organization. | True, False |

##### Internet Service Provider used to connect

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user connected via ISP**<br>*(FirstTimeUserConnectedViaISP)* | 30 | The ISP was observed for the first time by the user. | True, False |
| **ISP uncommonly used by user**<br>*(ISPUncommonlyUsedByUser)* | 10 | The ISP is not commonly used by the user. | True, False |
| **ISP uncommonly used among peers**<br>*(ISPUncommonlyUsedAmongPeers)* | 30 | The ISP is not commonly used among user's peers. | True, False |
| **First time connection via ISP in tenant**<br>*(FirstTimeConnectionViaISPInTenant)* | 30 | The ISP was observed for the first time in the organization. | True, False |
| **ISP uncommonly used in tenant**<br>*(ISPUncommonlyUsedInTenant)* | 30 | The ISP is not commonly used in the organization. | True, False |

##### Resource accessed

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **First time user accessed resource**<br>*(FirstTimeUserAccessedResource)* | 180 | The resource was accessed for the first time by the user. | True, False |
| **Resource uncommonly accessed by user**<br>*(ResourceUncommonlyAccessedByUser)* | 10 | The resource is not commonly accessed by the user. | True, False |
| **Resource uncommonly accessed among peers**<br>*(ResourceUncommonlyAccessedAmongPeers)* | 180 | The resource is not commonly accessed among user's peers. | True, False |
| **First time resource accessed in tenant**<br>*(FirstTimeResourceAccessedInTenant)* | 180 | The resource was accessed for the first time by anyone in the organization. | True, False |
| **Resource uncommonly accessed in tenant**<br>*(ResourceUncommonlyAccessedInTenant)* | 180 | The resource is not commonly accessed in the organization. | True, False |

##### Miscellaneous

| Enrichment name | [Baseline](#baseline-explained) (days) | Description | Sample value |
| --- | --- | --- | --- |
| **Last time user performed action**<br>*(LastTimeUserPerformedAction)* | 180 | Last time the user performed the same action. | \<Timestamp\> |
| **Similar action wasn't performed in the past**<br>*(SimilarActionWasn'tPerformedInThePast)* | 30 | No action in the same resource provider was performed by the user. | True, False |
| **Source IP location**<br>*(SourceIPLocation)* | *N/A* | The country resolved from the source IP of the action. | [Surrey, England] |
| **Uncommon high volume of operations**<br>*(UncommonHighVolumeOfOperations)* | 7 | A user performed a burst of similar operations within the same provider | True, False |
| **Unusual number of Microsoft Entra Conditional Access failures**<br>*(UnusualNumberOfAADConditionalAccessFailures)* | 5 | An unusual number of users failed to authenticate due to conditional access | True, False |
| **Unusual number of devices added**<br>*(UnusualNumberOfDevicesAdded)* | 5 | A user added an unusual number of devices. | True, False |
| **Unusual number of devices deleted**<br>*(UnusualNumberOfDevicesDeleted)* | 5 | A user deleted an unusual number of devices. | True, False |
| **Unusual number of users added to group**<br>*(UnusualNumberOfUsersAddedToGroup)* | 5 | A user added an unusual number of users to a group. | True, False |

### IdentityInfo table

After you [enable UEBA](enable-entity-behavior-analytics.md) for your Microsoft Sentinel workspace, data from your Microsoft Entra ID is synchronized to the **IdentityInfo** table in Log Analytics for use in Microsoft Sentinel. You can embed user data synchronized from your Microsoft Entra ID in your analytics rules to enhance your analytics to fit your use cases and reduce false positives.

While the initial synchronization may take a few days, once the data is fully synchronized:

- Changes made to your user profiles in Microsoft Entra ID are updated in the **IdentityInfo** table within 15 minutes.

- Group and role information is synchronized between the **IdentityInfo** table and Microsoft Entra ID daily.

- Every 14 days, Microsoft Sentinel re-synchronizes with your entire Microsoft Entra ID to ensure that stale records are fully updated.

- Default retention time in the **IdentityInfo** table is 30 days.


> [!NOTE]
> Currently, only built-in roles are supported.
>
> Data about deleted groups, where a user was removed from a group, is not currently supported.
>

The following table describes the user identity data included in the **IdentityInfo** table in Log Analytics.

| Field                           | Type     | Description                                                |
| ------------------------------- | -------- | ---------------------------------------------------------- |
| **AccountCloudSID**             | string   | The Microsoft Entra security identifier of the account.           |
| **AccountCreationTime**         | datetime | The date the user account was created (UTC).               |
| **AccountDisplayName**          | string   | The display name of the user account.                      |
| **AccountDomain**               | string   | The domain name of the user account.                       |
| **AccountName**                 | string   | The user name of the user account.                         |
| **AccountObjectId**             | string   | The Microsoft Entra object ID for the user account. |
| **AccountSID**                  | string   | The on-premises security identifier of the user account.   |
| **AccountTenantId**             | string   | The Microsoft Entra tenant ID of the user account.  |
| **AccountUPN**                  | string   | The user principal name of the user account.               |
| **AdditionalMailAddresses**     | dynamic  | The additional email addresses of the user.                |
| **AssignedRoles**               | dynamic  | The Microsoft Entra roles the user account is assigned to.        |
| **BlastRadius**                 | string   | A calculation based on the position of the user in the org tree and the user's Microsoft Entra roles and permissions. <br>Possible values: *Low, Medium, High* |
| **ChangeSource**                | string   | The source of the latest change to the entity. <br>Possible values:<br>- *AzureActiveDirectory*<br>- *ActiveDirectory*<br>- *UEBA*<br>- *Watchlist*<br>- *FullSync* |
| **City**                        | string   | The city of the user account.                              |
| **Country**                     | string   | The country of the user account.                           |
| **DeletedDateTime**             | datetime | The date and time the user was deleted.                    |
| **Department**                  | string   | The department of the user account.                        |
| **GivenName**                   | string   | The given name of the user account.                        |
| **GroupMembership**             | dynamic  | Microsoft Entra groups where the user account is a member.        |
| **IsAccountEnabled**            | bool     | An indication as to whether the user account is enabled in Microsoft Entra ID or not. |
| **JobTitle**                    | string   | The job title of the user account.                         |
| **MailAddress**                 | string   | The primary email address of the user account.             |
| **Manager**                     | string   | The manager alias of the user account.                     |
| **OnPremisesDistinguishedName** | string   | The Microsoft Entra ID distinguished name (DN). A distinguished name is a sequence of relative distinguished names (RDN), connected by commas. |
| **Phone**                       | string   | The phone number of the user account.                      |
| **SourceSystem**                | string   | The system where the user is managed. <br>Possible values:<br>- *AzureActiveDirectory*<br>- *ActiveDirectory*<br>- *Hybrid* |
| **State**                       | string   | The geographical state of the user account.                |
| **StreetAddress**               | string   | The office street address of the user account.             |
| **Surname**                     | string   | The surname of the user. account.                          |
| **TenantId**                    | string   | The tenant ID of the user.                                 |
| **TimeGenerated**               | datetime | The time when the event was generated (UTC).               |
| **Type**                        | string   | The name of the table.                                     |
| **UserAccountControl**          | dynamic  | Security attributes of the user account in the AD domain. <br> Possible values (may contain more than one):<br>- *AccountDisabled*<br>- *HomedirRequired*<br>- *AccountLocked*<br>- *PasswordNotRequired*<br>- *CannotChangePassword*<br>- *EncryptedTextPasswordAllowed*<br>- *TemporaryDuplicateAccount*<br>- *NormalAccount*<br>- *InterdomainTrustAccount*<br>- *WorkstationTrustAccount*<br>- *ServerTrustAccount*<br>- *PasswordNeverExpires*<br>- *MnsLogonAccount*<br>- *SmartcardRequired*<br>- *TrustedForDelegation*<br>- *DelegationNotAllowed*<br>- *UseDesKeyOnly*<br>- *DontRequirePreauthentication*<br>- *PasswordExpired*<br>- *TrustedToAuthenticationForDelegation*<br>- *PartialSecretsAccount*<br>- *UseAesKeys* |
| **UserState**                   | string   | The current state of the user account in Microsoft Entra ID.<br>Possible values:<br>- *Active*<br>- *Disabled*<br>- *Dormant*<br>- *Lockout* |
| **UserStateChangedOn**          | datetime | The date of the last time the account state was changed (UTC). |
| **UserType**                    | string   | The user type.                                             |

## Next steps

This document described the Microsoft Sentinel entity behavior analytics table schema.

- Learn more about [entity behavior analytics](identify-threats-with-entity-behavior-analytics.md).
- [Enable UEBA in Microsoft Sentinel](enable-entity-behavior-analytics.md).
- [Put UEBA to use](investigate-with-ueba.md) in your investigations.
