---
title: Microsoft Sentinel solution for Microsoft Power Platform - security content reference
description: Learn about the built-in security content provided by the Microsoft Sentinel solution for Power Platform.
author: cwatson-cat
ms.author: cwatson
ms.topic: reference
ms.date: 07/13/2023
---

# Microsoft Sentinel solution for Microsoft Power Platform: security content reference

This article details the security content available for the Microsoft Sentinel solution for Power Platform. For more information about this solution, see [Microsoft Sentinel solution for Microsoft Power Platform overview](power-platform-solution-overview.md).
 
> [!IMPORTANT]
> The Microsoft Sentinel solution for Power Platform is currently in PREVIEW. The [Azure Preview Supplemental Terms](https://azure.microsoft.com/support/legal/preview-supplemental-terms/) include additional legal terms that apply to Azure features that are in beta, preview, or otherwise not yet released into general availability.

## Built-in analytics rules

The following analytic rules are included when you install the solution for Power Platform. The data sources listed include the data connector name and table in Log Analytics.

| Rule name | Description | Source action | Tactics |
| --------- | --------- | --------- | --------- |
|PowerApps - App activity from unauthorized geo|Identifies Power Apps activity from countries in a predefined list of unauthorized countries.<br><br>This detection cross-correlates Power Apps activity logs with Azure Active Directory (Azure AD) sign-in logs. It requires that you enable the Azure AD data connector in Microsoft Sentinel. The Azure AD data connector is available in the Azure Active Directory solution from the Microsoft Sentinel content hub.<br><br>To change the unauthorized country codes, update the `unauthorized_country_codes` variable in the rule query. The default is `None`. Get the list of ISO 3166-1 alpha-2 country codes from [ISO Online Browsing Platform (OBP)](https://www.iso.org/obp/ui).|Run an activity in Power App from a country that's on the unauthorized country code list.<br><br>**Data sources**: <br>- Power Platform Inventory (using Azure Functions) <br>`PowerApps_CL`<br>`PowerPlatformEnvironments_CL`<br>- Microsoft Power Apps (Preview)<br>`PowerAppsActivity`<br>- Azure Active Directory<br>`SigninLogs`<br>`AuditLogs`<br>`AADNonInteractiveUserSignInLogs`<br>`AADServicePrincipalSignInLogs`<br>`AADManagedIdentitySignInLogs`<br>`AADProvisioningLogs`<br>`ADFSSignInLogs`<br>`AADUserRiskEvents`<br>`AADRiskyUsers`<br>`NetworkAccessTraffic`<br>`AADRiskyServicePrincipals`<br>`AADServicePrincipalRiskEvents`<br>|Initial access|
|PowerApps - Multiple apps deleted|Identifies mass delete activity where multiple Power Apps are deleted within a period of 1 hour, matching a predefined threshold of total apps deleted or app deleted events across multiple Power Platform environments.<br><br>Default threshold values: <br>Total apps deleted = 5<br>Total number of Power Platform environments that observed Power apps deletions = 5<br><br>Change the threshold by updating the values in the rule query.|Delete many Power Apps from the Power Platform admin center. <br><br>**Data sources**:<br>- Power Platform Inventory (using Azure Functions)<br>`PowerApps_CL`<br>`PowerPlatformEnvironments_CL`<br>- Microsoft Power Apps (Preview)<br>`PowerAppsActivity`|Impact|
|PowerApps - Data destruction following publishing of a new app|Identifies a chain of events when a new app is created or published and is followed within 1 hour by mass update or delete events in Dataverse. If the app publisher is on the list of users in the **TerminatedEmployees** watchlist template, the incident severity is raised.<br><br>Default threshold values:<br>Record deletion = 25<br>record update = 50<br><br>To use the **TerminatedEmployees** watchlist, create and populate the watchlist from a default template. For more information, see [Use watchlists in Microsoft Sentinel](/azure/sentinel/watchlists).|Delete a number of records in Power Apps within 1 hour of the Power App being created or published.<br><br>**Data sources**:<br>- Power Platform Inventory (using Azure Functions)<br>`PowerApps_CL`<br>`PowerPlatformEnvironments_CL`<br>- Microsoft Power Apps (Preview)<br>`PowerAppsActivity`<br>- Dynamics 365<br>`Dynamics365Activity`|Impact|
|PowerApps - Multiple users accessing a malicious link after launching new app|Identifies a chain of events when a new Power App is created and is followed by these events:<br>- Multiple users launch the app within the detection window.<br>- Multiple users open the same malicious URL.<br><br>Default threshold values:<br>- Distinct number of users launching the potentially malicious app = 1<br>- Distinct number of users clicking the potentially malicious link = 1<br><br>The threshold  detects a spear-phishing scenario where a specific victim is targeted, launches the malicious app, and opens the known malicious link in the app. Increase the threshold for general phishing scenarios and to decrease possible false positives.<br><br>This detection cross correlates Power Apps execution logs with malicious URL click events from either of the following sources:<br>- The Microsoft 365 Defender data connector or <br>- Malicious URL indicators of compromise (IOC) in Microsoft Sentinel Threat Intelligence with the Advanced Security Information Model (ASIM) web session normalization parser. <br>Make sure either the Microsoft 365 Defender data connector or Microsoft Sentinel Threat intelligence with ASIM web session parsers are enabled. For more information, see the following articles:<br>- [Microsoft 365 Defender connector for Microsoft Sentinel](/azure/sentinel/data-connectors/microsoft-365-defender)<br>- [Understand threat intelligence in Microsoft Sentinel](/azure/sentinel/understand-threat-intelligence)<br>-  [Microsoft Sentinel Advanced Security Information Model (ASIM) parsers - web session parsers](/azure/sentinel/normalization-parsers-list#web-session-parsers).|Within 1 hour of creating, publishing, or sharing an app, open a known malicious URL from the app.<br><br>**Data sources**:<br>- Power Platform Inventory (using Azure Functions)<br>`PowerApps_CL`<br>`PowerPlatformEnvironments_CL`<br>- Microsoft Power Apps (Preview)<br>`PowerAppsActivity`|Tactics and techniques|
|PowerAutomate - Departing employee flow activity|Identifies instances where an employee who has been notified or is already terminated creates or modifies a Power Automate flow.<br><br>This analytics rule uses the **TerminatedEmployees** watchlist.<br><br>To use the **TerminatedEmployees** watchlist, create and populate the watchlist from a default template. For more information, see [Use watchlists in Microsoft Sentinel](/azure/sentinel/watchlists).|User defined in the **TerminatedEmployees** watchlist creates or updates a Power Automate flow.<br><br>**Data sources**:<br>Microsoft Power Automate (Preview)<br>`PowerAutomateActivity`|Tactics and techniques|
|PowerPlatform - Connector added to a sensitive environment|Identifies the creation of new API connectors within Power Platform, specifically targeting a predefined list of sensitive environments.<br><br>Update the list of sensitive environments by modifying the `sensitive_environment_id` in the rule query. |Add a new Power Platform connector in a sensitive Power Platform environment.<br><br>**Data sources**:<br>Microsoft Power Platform Connectors (Preview)<br>`PowerPlatformConnectorActivity`|Tactics and techniques|
|PowerPlatform - DLP policy updated or removed|Identifies changes to the data loss prevention policy, specifically policies that are updated or removed.|Update or remove a Power Platform data loss prevention policy in Power Platform environment.<br><br>**Data sources**:<br>Microsoft Power Platform DLP (Preview)<br>`PowerPlatformDlpActivity`|Tactics and techniques|

For more information about analytic rules, see [Detect threats out-of-the-box](../detect-threats-built-in.md).