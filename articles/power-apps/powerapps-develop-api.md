<properties
	pageTitle="Develop API for PowerApps (.Net)"
	description="Develop API for PowerApps (.Net)"
	services="powerapps"
	documentationCenter="" 
	authors="rajram"
	manager="dwrede"
	editor=""/>

<tags
   ms.service="powerapps"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="" 
   ms.date="11/03/2015"
   ms.author="rajram"/>

#Develop API for PowerApps (.Net)

Developing API for PowerApps involves the following steps

- Authoring your web API
- Generating Swagger for your web API
- Registering your Web API

##Authoring your web API
Authoring your web API that works with PowerApps is as simple as creating any web API. To get started, follow the instructions in this article to [Create an ASP.NET API app in Azure App Service][1]
> Todo: Need to update the API App article or author another one to reflect the latest changes

##Generating Swagger for your web API
[Swashbuckle][2] automatically adds a [Swagger][3] to WebAPI projects.
>Todo: Link to API App article for Swashbuckle integration overview

###Schema extensions

 However apart from the swagger generated by Swashbuckle, there are few swagger extensions to be aware of while creating an API for PowerApps.

**x-ms-summary**

This is a string that is used to describe display names for entities which do not have a summary field defined in the Swagger spec (example: parameter names).

**x-ms-visibility**

This can take one of 3 values: “none” (default) | “advanced” | “internal”
	
- Additional value defined for PowerFlows:
		
	○ "important": If an operation is marked as 'important', the Powerflow client is expected to highlight these operations.

**x-ms-notification-url**

(boolean) This indicates that this field should be populated with the callback URI of the Logic app at runtime.

**x-ms-notification-content**

This should be present on the paths that support subscriptions. It informs the Logic app what the payload of the notification will be so that the UI can reference the properties of the content.
 

```json

{ 
    "paths": { 
        "/pet/{petId}/$subscriptions": { 
            "xs-ms-notification-content": { 
                "description": "Pet details on a WebHook", 
                "schema": { 
                    "$ref": "#/definitions/Pet" 
                } 
            }, 
            "get": { 
    // For listing subscirptions 
            }, 
            "post": { 
                "parameters": [ 
                    { 
                        "name": "petId", 
                        "in": "path", 
                        "description": "ID of pet that needs to be subscribed too", 
                        "required": true, 
                        "type": "integer", 
                        "format": "int64" 
                    }, 
                    { 
                        "in": "body", 
                        "description": "Content of the subscription", 
                        "required": true, 
                        "schema": { 
                            "$ref": "#/definitions/SubscriptionRequest" 
                        } 
                    } 
                ], 
                "responses": { 
                    "201": { 
                        "description": "Subscription created", 
                        "schema": { 
                            "type": "object", 
                            "items": { 
                                "$ref": "#/definitions/SubscriptionResponse" 
                            } 
                        } 
                    } 
                } 
            } 

        } 
    }, 
    "definitions": { 
        "SubscriptionRequest": { 
            "type": "object", 
            "properties": { 
                "resource": { 
                    "type": "string" 
                }, 
                "notificationUrl": { 
                    "type": "string", 
                    "description": "The url to call back to", 
                    "x-ms-notification-url" :  true 
                }, 
                "context": { 
                    "type": "string", 
                    "description" :  "Any content to be included in the call" 
                } 
            } 
... 
```

**x-ms-trigger**

This defines whether this operation can be used as a trigger in the client (PowerFlow).  This can take the following values:
	
	o none (default): The operation cannot be used as a trigger.
	o single: This operation can also be used as a trigger.  See the spec above for details.
	o batched: This operation can be used as a trigger.  In addition, this operation responds with a JSON  'array' of objects, and the client (PowerFlow) is expected to fire a trigger for each item in the array.  See the spec above for details.

**x-ms-dynamic-values**

This is a hint to the client (PowerFlow) that the API provides a list of allowed value for this parameter dynamically.  The client can invoke an operation as defined by the value of this field, and extract the possible values from the result.  The client can then display these values as options to the end user.  
The value is an object that contains the following properties:
	
	o operationId: A string that matches the operationId for the operation to be invoked
	o parameters: An object whose properties define the parameters required for the operation
	o value-collection: A path string that evaluates to an array of objects in the response payload
	o value-path: A path string in the object inside "value-collection" that refers to the value for the parameter.
	o value-title: A path string in the object inside "value-collection" that refers to a description for the value.

Example:
	 
```json
       "/api/tables/{table}/items": {
            "post": {
                "operationId": "TableData_CreateItem",
                "summary": "Create an object in {Salesforce}",
                "parameters": [
                    {
                        "name": "table",
                        "x-ms-summary": "Object Type",
                        "x-ms-dynamic-values": {
                            "operationId": "TableMetadata_ListTables",      // operation that needs to be invoked
                            "parameters": { },                              // parameters for the above operation, if any
                            "value-collection": "values",                   // field that contains the collection
                            "value-path": "Name",                           // field that contains the value
                            "value-title": "DisplayName"                    // field that contains a display name for the value
                        },
``` 

**x-ms-dynamic-schema** 

This is a hint to the client (PowerFlow) that the schema for this parameter (or response) is dynamic in nature.  The client  can invoke an operation as defined by the value of this field, and discover the schema dynamically.  The client can then display an appropriate UI to take inputs from the user or display available fields.  Example:
 
```json
                    {
                        "name": "item",
                        "in": "body",
                        "required": true,
                        "x-ms-dynamic-schema": {
                            "operationId": "Metadata_GetTableSchema",
                            "parameters": {
                                "tablename": "{table}"              // the value that the user has selected from the above parameter
                            },
                            "value-path": "Schema"                // the field that contains the JSON schema
                        },
```

**x-ms-sample-invoke**

This is a hint to the client (PowerApps) that this operation supports a “Try-It” feature.  Allowed values are:

	o disable: Disables the Try-It feature.
	o enable (default): Enables the Try-It feature.

**x-ms-sample-value**

This is a hint to the client (PowerApp) that this parameter should use the value defined here for the “Try-It” feature.  Its value must be of a valid type as the parameter.

##Registering your Web API
> Todo: Link to API App docs for registering web API


<!--References-->
[1]: https://azure.microsoft.com/en-us/documentation/articles/app-service-dotnet-create-api-app/
[2]: https://github.com/domaindrivendev/Swashbuckle
[3]: http://swagger.io/