### YamlMime:FAQ
metadata:
  title: "Network Watcher Frequently Asked Questions (FAQ)"
  description: "This article answers frequently asked questions asked about the Azure Network Watcher service."
  author: halkazwini
  ms.author: halkazwini
  ms.service: azure-network-watcher
  ms.topic: faq
  ms.date: 09/03/2025
title: "Network Watcher frequently asked questions (FAQ)"
summary: |
  This article provides answers to the most frequently asked questions about Azure Network Watcher.
  

sections:
  - name: General
    questions:
      - question: |
          What is Network Watcher?
        answer: |
          [Network Watcher](network-watcher-overview.md) provides a suite of tools to monitor, diagnose, view metrics, and enable or disable logs for IaaS (Infrastructure-as-a-Service) resources, which include virtual machines, virtual networks, application gateways, load balancers, and other resources in an Azure virtual network. It isn't a solution for monitoring PaaS (Platform-as-a-Service) infrastructure or getting web/mobile analytics.

      - question: |
          What tools does Network Watcher provide?
        answer: |
          Network Watcher provides three major sets of capabilities:
          * Monitoring
            * [Topology view](view-network-topology.md) shows you the resources in your virtual network and the relationships between them.
            * [Connection monitor](connection-monitor-overview.md) allows you to monitor connectivity and latency between endpoints inside and outside Azure.
          * Network diagnostic tools
            * [IP flow verify](network-watcher-ip-flow-verify-overview.md) allows you to detect traffic filtering issues at a virtual machine level.
            * [NSG diagnostics](nsg-diagnostics-overview.md) allows you to detect traffic filtering issues at a virtual machine, virtual machine scale set, or application gateway level.
            * [Next hop](network-watcher-next-hop-overview.md) helps you verify traffic routes and detect routing issues.
            * [Connection troubleshoot](network-watcher-connectivity-portal.md) enables a one-time connectivity and latency check between a virtual machine and Bastion host, application gateway, or another virtual machine.
            * [Packet capture](network-watcher-packet-capture-overview.md) enables you to capture your virtual machine traffic.
            * [VPN troubleshoot](network-watcher-troubleshoot-overview.md) runs multiple diagnostics checks on your VPN gateways and connections to help debug issues.
          * Traffic
            * [Virtual network flow logs](vnet-flow-logs-overview.md) and [network security group flow logs](network-watcher-nsg-flow-logging-overview.md) allow you to log network traffic passing through your virtual networks and network security groups (NSGs) respectively.
            * [Traffic analytics](traffic-analytics.md) processes your network security group flow log data enabling you to visualize, query, analyze, and understand your network traffic.
          
          For more detailed information, see [Network Watcher overview](network-watcher-overview.md).
          
      - question: |
          How does Network Watcher pricing work?
        answer: |
          See [Network Watcher pricing](https://azure.microsoft.com/pricing/details/network-watcher/) for pricing details about different Network Watcher components.

      - question: |
          In which regions is Network Watcher currently supported and available?
        answer: |
          See [Network Watcher regions](https://azure.microsoft.com/global-infrastructure/services/?products=network-watcher) to learn about the regions that support Network Watcher.
          
      - question: |
          What permissions are required to use Network Watcher?
        answer: |
          See [Azure RBAC permissions required to use Network Watcher](required-rbac-permissions.md) for a detailed list of required permissions for each of capability of Network Watcher.
          
      - question: |
          How do I enable Network Watcher?
        answer: |
          The Network Watcher service is automatically enabled for every subscription. You must manually enable Network Watcher if you opted out Network Watcher automatic enablement. For more information, see [Enable or disable Azure Network Watcher](network-watcher-create.md).
          
      - question: |
          What is the Network Watcher deployment model?
        answer: |
          The Network Watcher parent resource is deployed with a unique instance in every region. Default naming format: NetworkWatcher_RegionName. Example: NetworkWatcher_centralus is the Network Watcher resource for the "Central US" region. You can customize the name of Network Watcher instance using [PowerShell](network-watcher-create.md?tabs=powershell#enable-network-watcher-for-your-region) or [REST API](/rest/api/network-watcher/network-watchers/create-or-update).

      - question: |
          Why does Azure allow only one instance of Network Watcher per region? 
        answer: |
          Network Watcher just needs to be enabled once per a region per a subscription for its features to work. Network Watcher is enabled in a region by creating a Network Watcher instance in that region.

      - question: |
          How can I manage Network Watcher resource? 
        answer: |
          The Network Watcher resource represents the backend service for Network Watcher, which is fully managed by Azure. However, you can create or delete the Network Watcher resource to enable or disable it in a particular region. For more information, see [Enable or disable Azure Network Watcher](network-watcher-create.md).

      - question: |
          Can I move Network Watcher instance from one region to another? 
        answer: |
          No, moving Network Watcher resource or any of its child resources across regions isn't supported. For more information, see [Move operation support for networking resources](../azure-resource-manager/management/move-support-resources.md#microsoftnetwork).

      - question: |
          Can I move Network Watcher instance from one resource group to another? 
        answer: |
          Yes, moving Network Watcher resource between resource groups is supported. For more information, see [Move operation support for networking resources](../azure-resource-manager/management/move-support-resources.md#microsoftnetwork).

      - question: |
          What is the NetworkWatcherRG?
        answer: |
          NetworkWatcherRG is a resource group that's automatically created for Network Watcher resources. For example, Network Watcher regional instances and the network security group flow log resources are created in **NetworkWatcherRG** resource group. You can customize the name of Network Watcher resource group using [PowerShell](network-watcher-create.md?tabs=powershell#enable-network-watcher-for-your-region), [Azure CLI](network-watcher-create.md?tabs=cli#enable-network-watcher-for-your-region), or [REST API](/rest/api/network-watcher/network-watchers/create-or-update).

      - question: |
          Does Network Watcher store customer data?
        answer: |
          Azure Network Watcher doesn't store customer data, except for the Connection monitor. Connection monitor stores customer data, which is automatically stored by Network Watcher in a single region to satisfy in-region data residency requirements.

      - question: |
          What are the resource limits on Network Watcher?
        answer: |
          Network Watcher has the following limits:
          [!INCLUDE [network-watcher-limits](../../includes/network-watcher-limits.md)]

  - name: Service availability and redundancy
    questions:
      - question: |
          Is the Network Watcher zone resilient?
        answer: |
          Yes, the Network Watcher service is zone-resilient by default.

      - question: |
          How do I configure the Network Watcher service to be zone-resilient?
        answer: |
          No configuration is necessary to enable zone-resiliency. Zone-resiliency for Network Watcher resources is available by default and managed by the service itself.

  - name: Network Watcher Agent
    questions:
      - question: |
          Why do I need to install the Network Watcher Agent? 
        answer: |
          The Network Watcher Agent is required for any Network Watcher feature that generates or intercepts traffic from a virtual machine. 

      - question: |
          Which features require the Network Watcher Agent?
        answer: |
          The Connection monitor, Packet capture, and Connection troubleshoot (connectivity test) features require the Network Watcher extension to be present.

      - question: |
          What is the latest version of the Network Watcher Agent?
        answer: |
          [!INCLUDE [Network Watcher agent version](../../includes/network-watcher-agent-version.md)]. For more information, see [Update Azure Network Watcher extension to the latest version](network-watcher-agent-update.md).

      - question: |
          What ports does the Network Watcher Agent use?
        answer: |
          - **Linux**: the Network Watcher Agent uses available ports starting from `port 50000` until it reaches `port 65535`.
          - **Windows**: the Network Watcher Agent uses the ports that the operating system responds with when queried for available ports.

      - question: |
          What IP addresses does the Network Watcher Agent communicate with?
        answer: |
          The Network Watcher Agent requires outbound TCP connectivity to `169.254.169.254` over `port 80` and `168.63.129.16` over `port 8037`. The agent uses these IP addresses to communicate with the Azure platform.

  - name: Connection monitor
    questions:
      - question: |
          Does connection monitor support classic VMs?
        answer: |
          No, connection monitor doesn't support classic VMs. For more information, see [Migrate IaaS resources from classic to Azure Resource Manager](/azure/virtual-machines/migration-classic-resource-manager-overview).

      - question: |
          What if my topology isn't decorated or my hops have missing information?
        answer: |
          Topology can be decorated from non-Azure to Azure only if the destination Azure resource and the connection monitor resource are in the same region.

      - question: |
          What happens if the connection monitor creation fails with the following error: "We don't allow creating different endpoints for the same VM"?
        answer: |
          The same Azure VM can't be used with different configurations in the same connection monitor. For example, using same VM with a filter and without a filter in the same connection monitor isn't supported.

      - question: |
          What happens if the test failure reason is "Nothing to display"?
        answer: |
          Issues that are displayed on the connection monitor dashboard are found during topology discovery or hop exploration. There can be cases where the threshold set for % loss or RTT is reached but no issues are found on hops.

      - question: |
          When migrating an existing connection monitor (classic) to the latest connection monitor, what happens if the external endpoint tests are migrated with the TCP protocol only?
        answer: |
          There's no protocol selection option in connection monitor (classic). Tests in connection monitor (classic) only use the TCP protocol, and that's why, during the migration, we create a TCP configuration in tests in the new connection monitor.

      - question: |
          Are there any limitations to using Azure Monitor and Arc Agents with connection monitor?
        answer: |
          There's currently a regional boundary when an endpoint uses Azure Monitor and Arc agents with the associated Log Analytics workspace. As a result to this limitation, the associated Log Analytics workspace must be in the same region as the Arc endpoint. Data ingested into individual workspaces can be unionized for a single view, see [Query data across Log Analytics workspaces, applications, and resources in Azure Monitor](/azure/azure-monitor/logs/cross-workspace-query).

  - name: Flow logs
    questions:
      - question: |
          What does flow logging do?
        answer: |
          Flow logs enable you to log 5-tuple flow information about your Azure IP traffic that passes through a network security group or Azure virtual network. The raw flow logs are written to an Azure storage account. From there, you can further process, analyze, query, or export them as needed.

      - question: |
          Do flow logs affect network latency or performance?
        answer: |
          Flow log data is collected outside the path of your network traffic, so it doesn't affect network throughput or latency. You can create or delete flow logs without any risk of impact to network performance.

      - question: |
          What is the difference between NSG flow logs and NSG diagnostics?
        answer: |
          Network security group flow logs record traffic flowing through a network security group. On the other hand, NSG diagnostics returns all network security groups that your traffic is traversing and the rules of each network security group that are applied to this traffic. Use NSG diagnostics to verify that your network security group rules are being applied as expected.

      - question: |
          Can I log ESP and AH traffic using network security group flow logs?
        answer: |
          No, network security group flow logs don't support ESP and AH protocols.

      - question: |
          Can I log ICMP traffic using flow logs?
        answer: |
          No, network security group flow logs and virtual network flow logs don't support ICMP protocol.

      - question: |
          Can I delete a network security group that has flow logging enabled?
        answer: |
          Yes. The associated flow log resource will be deleted too. Flow log data is retained in the storage account for the retention period configured in the flow log.

      - question: |
          Can I move a network security group that has flow logging enabled to a different resource group or subscription?
        answer: |
          Yes, but you must delete the associated flow log resource. After you migrate the network security group, you can re-create the flow logs to enable flow logging on it.

      - question: |
          Can I use a storage account in a different subscription than the network security group or virtual network that the flow log is enabled for?
        answer: |
          Yes, you can use a storage account from a different subscription as long as this subscription is in the same region of the network security group and associated with the same Microsoft Entra tenant of the network security group or virtual network's subscription.

      - question: |
          How do I use flow logs with a storage account behind a firewall?
        answer: |
          To use a storage account behind a firewall, you have to allow *trusted Azure services* to access your storage account:
          
          1. Go to the storage account by entering the storage account's name in the search box at the top of the portal.
          2. Under the **Security + networking**, select **Networking**, then select **Firewalls and virtual networks**.
          3. In **Public network access**, select **Enabled from selected virtual networks and IP addresses**. Then under **Exceptions**, check the box next to **Allow Azure services on the trusted services list to access this storage account.** 
          4. Enable flow logs by creating a flow log for your target resource using the storage account. For more information, see [Create a flow log](vnet-flow-logs-manage.md#create-a-flow-log).
          
          You can check the storage logs after a few minutes. You should see an updated TimeStamp or a new JSON file created.

      - question: |
          How many retention policy rules can a storage account have?
        answer: |
          Currently, a storage account supports 100 rules, and each rule can accommodate 10 blob prefixes. If you reach the limit, you can set the retention policy to ***0*** when you enable new virtual network flow logs, and then manually add a retention rule for the subscription.

          To create a retention policy subscription rule, follow these steps:
          1. Go to the storage account by entering the storage account's name in the search box at the top of the portal.
          1. Under **Data management**, select **Lifecycle management**.
          1. Select **+ Add rule**.
          1. In the **Details** section, select the following settings: **Rule scope:** *Limit blobs with filters*, **Blob type:** *Block blobs*, and **Blob subtype:** *Base blobs*.
          1. In the **Base blobs** section, configure your retention settings.
          1. In the **Filter set** section, format the **Blob prefix** as the following:
          `"insights-logs-flowlogflowevent/flowLogResourceID=/<yourSubscriptionId>_NETWORKWATCHERRG"`
          1. Select **Add**.

      - question: |
           What happens if I have both a flow log retention policy rule and a subscription-level rule at the same time?
        answer: |
          The rule with shorter retention period takes precedence.

      - question: |
          Why do I see some 403 errors in storage account activity logs?
        answer: |
          Network Watcher has a built-in fallback mechanism that it uses when connecting to a storage account behind a firewall (firewall enabled). It tries to connect to the storage account using a key, and if that fails, it switches to a token. In this case, a 403 error is logged in the storage account activity log.

      - question: |
          Can Network Watcher send flow logs data to a storage account enabled with Private Endpoint?
        answer: |
          Yes, Network Watcher supports sending flow logs data to a storage account enabled with a private endpoint.

      - question: |
          How do I use flow logs with a storage account behind a service endpoint?
        answer: |
          Flow logs are compatible with service endpoints without requiring any extra configuration. For more information, see [Enable a service endpoint](../virtual-network/tutorial-restrict-network-access-to-resources.md#enable-a-service-endpoint).
          
      - question: |
          What is the difference between flow logs versions 1 and 2?
        answer: |
          Flow logs version 2 introduces the concept of *flow state* and stores information about bytes and packets transmitted. For more information, see [Network security group flow log format](network-watcher-nsg-flow-logging-overview.md#log-format).

      - question: |
          Can I create a flow log for a network security group that has a read-only lock?
        answer: |
          No, a **read-only** lock on a network security group prevents the creation of the corresponding network security group flow log.

      - question: |
          Can I create a flow log for a network security group that has a cannot-delete lock?
        answer: |
          Yes, a **cannot-delete** lock on the network security group doesn't prevent the creation or modification of the corresponding network security group flow log.

      - question: |
          Can I automate network security group flow logs?
        answer: |
          Yes, you can automate network security group flow logs via Azure Resource Manager templates (ARM templates). For more information, see [Configure NSG flow logs using an Azure Resource Manager (ARM) template](quickstart-configure-network-security-group-flow-logs-from-arm-template.md).

  - name: Traffic analytics
    questions:
      - question: |
          Can I enable flow logs for resources that are in different regions than my workspace region?
        answer: |
          Yes, virtual networks and network security groups can be in different regions than your Log Analytics workspace region.

      - question: |
          Can multiple network security groups be configured within a single workspace?
        answer: |
          Yes.

      - question: |
          Why doesn't traffic analytics display data for my traffic analytics enabled network security groups? 
        answer: |
          In the resource selection dropdown in the traffic analytics dashboard, the resource group of the **Virtual Network** resource must be selected, not the resource group of the virtual machine or network security group.  

      - question: |
          Why do some resources appear as "Unknown" in traffic analytics?
        answer: |
          Traffic analytics performs a resource discovery scan every 6 hours to identify new VMs, NICs, virtual networks, and subnets. When a new VM or NIC is created after the most recent discovery cycle, and flow data is collected before the next discovery, traffic analytics can't yet associate the traffic with a known resource. As a result, those resources are temporarily labeled as *unknown* in the analytics view.

      - question: |
          Can I restrict public access to the data collection endpoint (DCE) resource created by traffic analytics?
        answer: |
          Yes, you can disable public access to the data collection endpoint (DCE) resource to block public inbound traffic to it. Ingestion continues to work without associating the DCE resource with an Azure Monitor Private Link scope.

      - question: |
          Can I use an existing workspace?
        answer: |
          Yes. If you select an existing workspace, make sure that it was migrated to the new query language. If you don't want to upgrade the workspace, you need to create a new one. For more information about Kusto Query Language (KQL), see [Log queries in Azure Monitor](/azure/azure-monitor/logs/log-query-overview).

      - question: |
          Can my Azure storage account be in one subscription and my Log Analytics workspace be in a different subscription?
        answer: |
          Yes, your Azure storage account can be in one subscription, and your Log Analytics workspace can be in a different subscription.

      - question: |
          Can I store raw logs in a different subscription than the subscription used for network security groups or virtual networks?
        answer: |
          Yes. You can configure flow logs to be sent to a storage account located in a different subscription, provided you have the appropriate privileges, and that the storage account is located in the same region as the network security group (network security group flow logs) or virtual network (virtual network flow logs). The destination storage account must share the same Microsoft Entra tenant of the network security group or virtual network.

      - question: |
          Can my flow log resources and storage accounts be in different tenants?
        answer: |
          No. All resources must be in the same tenant including network security groups (network security group flow logs), virtual networks (virtual network flow logs), flow logs, storage accounts and Log Analytics workspaces (if traffic analytics is enabled).

      - question: |
          Can I configure a different retention policy for the storage account than Log Analytics workspace?
        answer: |
          Yes.

      - question: |
          When viewing my Traffic Analytics workbooks, my data doesn't load due to 'low memory error'. How can I fix this to view my data in workbook? 
        answer: |
          Traffic Analytics workbooks are powered by Log Analytics queries. If the query exceeds limits for log analytics, the workbook could present low memory errors. To improve performance and reduce low memory errors, users can use Dedicated Log Analytics Clusters.

      - question: |
          Will I lose the data stored in Log Analytics workspace if I delete the storage account used for flow logging?
        answer: |
          No. If you delete the storage account that is used for flow logs, the data stored in Log Analytics workspace won't be affected. You can still view historic data in Log Analytics workspace (some metrics will be impacted) but traffic analytics will no longer process any new flow logs until you update the flow logs to use a different storage account.

      - question: |
          What if I can't configure a network security group for traffic analytics due to a "Not found" error?
        answer: |
          Select a supported region. If you select a nonsupported region, you receive a "Not found" error. For more information, see [Traffic analytics supported regions](./supported-region-traffic-analytics.md).

      - question: |
          What if I'm getting the status: “Failed to load” in the flow logs page?
        answer: |
          The `Microsoft.Insights` provider must be registered for flow logging to work properly. If you aren't sure whether the `Microsoft.Insights` provider is registered for your subscription, see [Manage NSG flow logs](nsg-flow-logs-manage.md#register-insights-provider) instructions on how to register it.
          
      - question: |
          I configured the solution. Why am I not seeing anything on the dashboard?
        answer: |
          The dashboard might take up to 30 minutes to show reports for the first time. The solution must first aggregate enough data for it to derive meaningful insights, then it generates reports. 

      - question: |
          What if I get this message: “We couldn't find any data in this workspace for selected time interval. Try changing the time interval or select a different workspace.”?
        answer: |
          Try the following options:
          - Change the time interval in the upper bar.
          - Select a different Log Analytics workspace in the upper bar.
          - Try accessing traffic analytics after 30 minutes, if it was recently enabled.
          
      - question: |
          What if I get this message: "Analyzing your NSG flow logs for the first time. This process may take 20-30 minutes to complete. Check back after some time."?
        answer: |
          You might see this message because:
          - Traffic analytics was recently enabled, and might not yet have aggregated enough data for it to derive meaningful insights.
          - You're using the free version of the Log Analytics workspace, and it exceeded the quota limits. You might need to use a workspace with a larger capacity.

          Try the suggested solutions for the previous question. If problems persist, raise concerns in [Microsoft Q&A](/answers/topics/azure-network-watcher.html).
              
      - question: |
          What if I get this message: “Looks like we have resources data (Topology) and no flows information. For more information, click here to see resources data and refer to FAQ.”?
        answer: |
          You're seeing the resources information on the dashboard; however, no flow-related statistics are present. Data might not be present because of no communication flows between the resources. Wait for 60 minutes, and recheck status. If the problem persists, and you're sure that communication flows among resources exist, raise concerns in [Microsoft Q&A](/answers/topics/azure-network-watcher.html).

      - question: |
          How is traffic analytics priced?
        answer: |
          Traffic analytics is metered. The metering is based on processing of raw flow log data by the service. For more information, see [Network Watcher pricing](https://azure.microsoft.com/pricing/details/network-watcher/).          
          Enhanced logs ingested in Log Analytics workspace can be retained at no charge for up to first 31 days (or 90 days if Microsoft Sentinel is enabled on the workspace). For more information, see [Azure Monitor pricing](https://azure.microsoft.com/pricing/details/monitor/).
          
      - question: |
          How frequently does traffic analytics process data?
        answer: |
          Default processing interval of traffic analytics is 60 minutes, however, you can select accelerated processing at 10 minutes intervals. For more information, see [Data aggregation in traffic analytics](./traffic-analytics-schema.md#data-aggregation).

      - question: |
          What are the other resources created with my workspace?
        answer: |
          Traffic analytics creates and manages data collection rule (DCR) and data collection endpoint (DCE) resources in the same resource group as the workspace, prefixed with `NWTA`. If you perform any operation on these resources, traffic analytics might not function as expected. For more information, see [Data aggregation in traffic analytics](./traffic-analytics-schema.md#data-aggregation). For more information, see [Data collection rules in Azure Monitor](/azure/azure-monitor/essentials/data-collection-rule-overview?toc=/azure/network-watcher/toc.json) and [Data collection endpoints in Azure Monitor](/azure/azure-monitor/essentials/data-collection-endpoint-overview?toc=/azure/network-watcher/toc.json).

      - question: |
          Can I apply locks to the DCE and DCR resources created by traffic analytics? 
        answer: |
          It isn't recommended to apply locks to DCR and DCE resources created by traffic analytics as these resources are managed by the service. Locked resources aren't cleaned up upon deletion of the related flow logs. If you perform any operation on these resources, traffic analytics might not function as expected. For more information, see [Data aggregation in traffic analytics](./traffic-analytics-schema.md#data-aggregation).

      - question: |
          How does traffic analytics decide that an IP is malicious? 
        answer: |
          Traffic analytics relies on Microsoft internal threat intelligence systems to deem an IP as malicious. These systems use diverse telemetry sources like Microsoft products and services, the Microsoft Digital Crimes Unit (DCU), the Microsoft Security Response Center (MSRC), and external feeds and build intelligence on top of it. 
          Some of this data is Microsoft Internal. If a known IP is getting flagged as malicious, create a support ticket to know the details.
          
      - question: |
          How can I set alerts on traffic analytics data?
        answer: |
          Traffic analytics doesn't have built-in support for alerts. However, since traffic analytics data is stored in Log Analytics, you can write custom queries and set alerts on them. 
          Follow these steps:
          - You can use Log Analytics link in traffic analytics. 
          - Use the [traffic analytics schema](traffic-analytics-schema.md) to write your queries.
          - Select **New alert rule** to create the alert.
          - See [Create a new alert rule](/azure/azure-monitor/alerts/alerts-log) to create the alert.

      - question: |
          Is traffic analytics supported in a Log Analytics workspace with Network Security Perimeter enabled?
        answer: |
          No, it's currently not supported. If a Log Analytics workspace is deployed behind a network security perimeter, traffic analytics won't be able to ingest data from it.

  - name: Network diagnostic tools
    questions:
      - question: | 
          Are there any limitations with network diagnostics tools for Application Gateway?
        answer: |
          Yes. Connection troubleshoot and NSG diagnostics don't support private Application Gateway deployments. For more information, see [Private Application Gateway deployment](/azure/application-gateway/application-gateway-private-deployment).

