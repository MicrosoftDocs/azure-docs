---
title: Monitor operations, events, and counters for public Basic Load Balancer
titleSuffix: Azure Load Balancer
description: Learn how to enable alert events, and probe health status logging for public Basic Load Balancer
services: load-balancer
documentationcenter: na
author: asudbring
ms.service: load-balancer
ms.devlang: na
ms.topic: how-to
ms.custom: seodec18
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/05/2020
ms.author: allensu
---

# Azure Monitor logs for the Azure Load Balancer

You can use different types of logs in Azure to manage and troubleshoot Basic Load Balancers. Some of these logs can be accessed through the portal. Logs can be streamed to an event hub or a Log Analytics workspace. All logs can be extracted from Azure blob storage, and viewed in different tools, such as Excel and Power BI.  You can learn more about the different types of logs from the list below.

* **Activity logs:** You can use [View activity logs to monitor actions on resources](../azure-resource-manager/management/view-activity-logs.md) to view all activity being submitted to your Azure subscription(s), and their status. Activity logs are enabled by default, and can be viewed in the Azure portal.
* **Standard Load Balancer Metrics:** You can use this log to query the metrics exported as logs for your Standard Azure Load Balancer.

> [!IMPORTANT]
> **Health Probe and Load Balancer Alert event logs are not currently functional and are listed in the [known issues for the Azure Load Balancer](whats-new.md#known-issues).** 

> [!IMPORTANT]
> Logs are only available for resources deployed in the Resource Manager deployment model. You cannot use logs for resources in the classic deployment model. For more information about the deployment models, see [Understanding Resource Manager deployment and classic deployment](../azure-resource-manager/management/deployment-models.md).

## Enable logging

Activity logging is automatically enabled for every Resource Manager resource. Enable event and health probe logging to start collecting the data available through those logs. Use the following steps to enable logging.

Sign in to the [Azure portal](https://portal.azure.com). If you don't already have a load balancer, [create a load balancer](./quickstart-load-balancer-standard-public-portal.md) before you continue.

1. In the portal, click **Resource groups**.
2. Select **\<resource-group-name>** where your load balancer is.
3. Select your load balancer.
4. Select **Activity log** > **Diagnostic settings**.
5. In the **Diagnostics settings** pane, under **Diagnostics settings**, select **+ Add diagnostic setting**.
6. In the **Diagnostics settings** creation pane, enter **myLBDiagnostics** in the **Name** field.
7. You have three options for the **Diagnostics settings**.  You can choose one, two or all three and configure each for your requirements:
   * **Archive to a storage account**
   * **Stream to an event hub**
   * **Send to Log Analytics**

    ### Archive to a storage account
    You'll need a storage account already created for this process.  To create a storage account, see [Create a storage account](../storage/common/storage-account-create.md?tabs=azure-portal)

    1. Select the checkbox next to **Archive to a storage account**.
    2. Select **Configure** to open the **Select a storage account** pane.
    3. Select the **Subscription** where your storage account was created in the pull-down box.
    4. Select the name of your storage account under **Storage account** in the pull-down box.
    5. Select OK.

    ### Stream to an event hub
    You'll need an event hub already created for this process.  To create an event hub, see [Quickstart: Create an event hub using Azure portal](../event-hubs/event-hubs-create.md)

    1. Select the checkbox next to **Stream to an event hub**
    2. Select **Configure** to open the **Select event hub** pane.
    3. Select the **Subscription** where your event hub was created in the pull-down box.
    4. **Select event hub namespace** in the pull-down box.
    5. **Select event hub policy name** in the pull-down box.
    6. Select OK.

    ### Send to Log Analytics
    You'll need to already have a log analytics workspace created and configured for this process.  To create a Log Analytics workspace, see [Create a Log Analytics workspace in the Azure portal](../azure-monitor/learn/quick-create-workspace.md)

    1. Select the checkbox next to **Send to Log Analytics**.
    2. Select the **Subscription** where your Log Analytics workspace is in the pull-down box.
    3. Select the **Log Analytics Workspace** in the pull-down box.


8.  Beneath the **METRIC** section in the **Diagnostics settings** pane, select the check box next to: **AllMetrics**

9. Verify everything looks correct and click **Save** at the top of the create **Diagnostic settings** pane.

## Activity log

The activity log is generated by default. It can be configured to be exported on a subscription level [following instructions in this article](https://docs.microsoft.com/azure/azure-monitor/platform/activity-log). Learn more about these logs by reading the [View activity logs to monitor actions on resources](../azure-resource-manager/management/view-activity-logs.md) article.

### View and analyze the activity log

You can view and analyze activity log data using any of the following methods:

* **Azure tools:** Retrieve information from the activity log through Azure PowerShell, the Azure Command Line Interface (CLI), the Azure REST API, or the Azure portal. Step-by-step instructions for each method are detailed in the [Audit operations with Resource Manager](../azure-resource-manager/management/view-activity-logs.md) article.
* **Power BI:** If you don't already have a [Power BI](https://powerbi.microsoft.com/pricing) account, you can try it for free. Using the [Azure Audit Logs integration for Power BI](https://powerbi.microsoft.com/integrations/azure-audit-logs/), you can analyze your data with pre-configured dashboards, or you can customize views to suit your requirements.

## Metrics as Logs
Using metrics to logs export functionality provided by Azure Monitor, you are able to export your Load Balancer metrics. These metrics will generate a log entry for each one minute sampling interval.

Metric to log export is enabled on a per resource level. You can enable these logs by going to the Diagnostic Settings blade, filtering by Resource Group, and selecting the Load Balancer you would like to enable metrics export for. When the Load Balancer diagnostic settings page is up, select AllMetrics to export eligible metrics as logs.

See the [Limitations](#limitations) section of this article for metric export limitations.

### View and analyze metrics as logs
After enabling AllMetrics in the diagnostic settings of your Standard Load Balancer, if using an Event Hub or Log Analytics workspace, these logs will be populated in the AzureMonitor table. If exporting to storage, connect to your storage account and retrieve the JSON log entries for event and health probe logs. Once you download the JSON files, you can convert them to CSV and view in Excel, Power BI, or any other data visualization tool. 

> [!TIP]
> If you are familiar with Visual Studio and basic concepts of changing values for constants and variables in C#, you can use the [log converter tools](https://github.com/Azure-Samples/networking-dotnet-log-converter) available from GitHub.

## Stream to an event hub
When diagnostic information is streamed to an event hub, it can be used for centralized log analysis in a third-party SIEM tool with Azure Monitor Integration. For more information, see [Stream Azure monitoring data to an event hub](../azure-monitor/platform/stream-monitoring-data-event-hubs.md#partner-tools-with-azure-monitor-integration)

## Send to Log Analytics
Resources in Azure can have their diagnostic information sent directly to a Log Analytics workspace where complex queries can be run against the information for troubleshooting and analysis.  For more information, see [Collect Azure resource logs in Log Analytics workspace in Azure Monitor](../azure-monitor/platform/resource-logs.md#send-to-log-analytics-workspace)

## Limitations
There are currently the following limitations when using the Metrics to Logs export feature for Load Balancers:
* Metrics are currently displayed using internal names when exported as logs you can find the mapping in the below table
* The dimensionality of metrics is not preserved. For example, with metrics such a DipAvailability (Health Probe Status), you will not be able to split or view by Backend IP address
* Used SNAT Ports and Allocated SNAT Ports metrics are not currently available for export as logs

## Next Steps
* [Review the available metrics for your Load Balancer](https://docs.microsoft.com/azure/load-balancer/load-balancer-standard-diagnostics)
* [Create and test queries following Azure Monitor instructions](https://docs.microsoft.com/azure/azure-monitor/log-query/log-query-overview)
* Provide feedback on this article or Load Balancer functionality using the links below
