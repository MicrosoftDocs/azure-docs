---
title: "Tutorial: Deploy static-rendered Next.js websites on Azure Static Web Apps"
description: "Generate and deploy Next.js dynamic sites with Azure Static Web Apps."
services: static-web-apps
author: craigshoemaker
ms.service: static-web-apps
ms.topic:  tutorial
ms.date: 05/08/2020
ms.author: cshoe
ms.custom: devx-track-js
---


# Deploy static-rendered Next.js websites on Azure Static Web Apps

In this tutorial, you learn to configure and deploy a [Next.js](https://nextjs.org) generated static website to [Azure Static Web Apps](overview.md).

## Prerequisites

- An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/).
- A GitHub account. [Create an account for free](https://github.com/join).
- [Node.js](https://nodejs.org) installed.

## Set up a Next.js app

Rather than using the Next.js CLI to create your app, you can use a starter repository. The starter repository contains an existing Next.js app. This application is configured with dynamic routes, which highlights a common deployment issue.

To begin, create a new repository under your GitHub account from a template repository.

1. Navigate to [https://github.com/staticwebdev/nextjs-starter/generate](https://github.com/login?return_to=/staticwebdev/nextjs-starter/generate)
1. Name the repository **nextjs-starter**
1. Next, clone the new repo to your machine. Make sure to replace `<YOUR_GITHUB_ACCOUNT_NAME>` with your account name.

    ```bash
    git clone http://github.com/<YOUR_GITHUB_ACCOUNT_NAME>/nextjs-starter
    ```

1. Navigate to the newly cloned Next.js app:

   ```bash
   cd nextjs-starter
   ```

1. Install dependencies:

    ```bash
    npm install
    ```

1. Start Next.js app in development:

    ```bash
    npm run dev
    ```

Navigate to `http://localhost:3000` to open the app, where you should see the following website open in your preferred browser:

:::image type="content" source="media/deploy-nextjs/start-nextjs-app.png" alt-text="Start Next.js app":::

When you click on a framework/library, you should see a details page about the selected item:

:::image type="content" source="media/deploy-nextjs/start-nextjs-details.png" alt-text="Details page":::

## Generate a static website

The starter template repository used in this tutorial is configured to build the application as a static site with dynamic routes. Review the `projects/[path].js` file for full Next.js-specific implementation details.

Make the following modifications to your application to complete the static site setup. 

1. To configure static routes, create file named _next.config.js_ at the root of your project and add the following code.

    ```javascript
    module.exports = {
      trailingSlash: true
    };
    ```

      This configuration maps `/` to the Next.js page that is served for the `/` route, and that is the _pages/index.js_ page file.

1. Update the _package.json_'s build script to also generate a static site after building, using the `next export` command. The `export` command generates a static site.

    ```json
    "scripts": {
      "dev": "next dev",
      "build": "next build && next export",
    },
    ```

    Now with this command in place, Static Web Apps will run the `build` script every time you push a commit.

1. Generate a static site:

    ```bash
    npm run build
    ```

    The static site is generated and copied into an _out_ folder at the root of your working directory.

    > [!NOTE]
    > This folder is listed in the _.gitignore_ file because it should be generated by CI/CD when you deploy.

## Push your static website to GitHub

Azure Static Web Apps deploys your app from a GitHub repository and keeps doing so for every pushed commit to a tracked branch. Use the following commands sync your changes to GitHub.

1. Stage all changed files

    ```bash
    git add .
    ```

1. Commit all changes

    ```bash
    git commit -m "Update build config"
    ```

1. Push your changes to GitHub.

    ```bash
    git push origin main
    ```

## Deploy your static website

The following steps show how to link the app you just pushed to GitHub to Azure Static Web Apps. Once in Azure, you can deploy the application to a production environment.

### Create a static app

1. Navigate to the [Azure portal](https://portal.azure.com).
1. Select **Create a Resource**.
1. Search for **Static Web Apps**.
1. Select **Static Web Apps**.
1. Select **Create**.
1. On the _Basics_ tab, enter the following values.

    | Property | Value |
    | --- | --- |
    | _Subscription_ | Your Azure subscription name. |
    | _Resource group_ | **my-nextjs-group**  |
    | _Name_ | **my-nextjs-app** |
    | _Plan type_ | **Free** |
    | _Region for Azure Functions API and staging environments_ | Select a region closest to you. |
    | _Source_ | **GitHub** |

1. Select **Sign in with GitHub** and authenticate with GitHub.

1. Enter the following GitHub values.

    | Property | Value |
    | --- | --- |
    | _Organization_ | Select the appropriate GitHub organization. |
    | _Repository_ | Select **nextjs-starter**. |
    | _Branch_ | Select **main**. |

1. In the _Build Details_ section, select **Custom** from the _Build Presets_ drop-down and keep the default values.

1. In the _App location_, enter **/** in the box.
1. Leave the _Api location_ box empty.
1. In the _Output location_ box, enter **out**.

### Review and create

1. Select the **Review + Create** button to verify the details are all correct.

1. Select **Create** to start the creation of the App Service Static Web App and provision a GitHub Action for deployment.

1. Once the deployment completes click, **Go to resource**.

1. On the _Overview_ window, click the *URL* link to open your deployed application.

If the website does note immediately load, then the background GitHub Actions workflow is still running. Once the workflow is complete, you can then click refresh the browser to view your web app.

You can check the status of the Actions workflows by navigating to the Actions for your repository:

```url
https://github.com/<YOUR_GITHUB_USERNAME>/nextjs-starter/actions
```

### Sync changes

When you created the app, Azure Static Web Apps created a GitHub Actions workflow file in your repository. You need to pull this file down to your local repository to synchronize your git history.

Return to the terminal and run the following command `git pull origin main`.

> [!div class="nextstepaction"]
> [Set up a custom domain](custom-domain.md)
