---
title: Security alert guide for Azure Security Center for IoT Preview| Microsoft Docs
description: Learn about security alerts and recommended remediation using Azure Security Center for IoT features and service.
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''

ms.assetid: a5c25cba-59a4-488b-abbe-c37ff9b151f9
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/24/2019
ms.author: mlottner

---
# Azure Security Center for IoT security alerts

> [!IMPORTANT]
> Azure Security Center for IoT is currently in public preview.
> This preview version is provided without a service level agreement, and is not recommended for production workloads. Certain features might not be supported or might have constrained capabilities. 
> For more information, see [Supplemental Terms of Use for Microsoft Azure Previews](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Azure Security Center (ASC) for IoT continuously analyzes your IoT solution using advanced analytics and threat intelligence to alert you to malicious activity.
In addition, you can create custom alerts based on your knowledge of expected device behavior.
An alert acts as an indicator of comprise, and should be investigated and remediated.

In this article, you will find a list of built-in alerts which can be triggered on your IoT Hub and/or IoT devices.
Beside built-in alert, ASC for IoT allows you to define custom alerts based on expected Hub and/or device behavior.
For more details, see [Create custom alerts](quickstart-create-custom-alerts.md).

## Built-in alerts for IoT devices

| Severity | Name                                                   | Data Source | Description                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|----------|--------------------------------------------------------|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| High     | Successful local login                                 | Agent       | Successful local device sign in detected                                                                                                                                                                                                                                                                                                                                                                                         |
| High     | Successful brute force                                  | Agent       | Multiple unsuccessful login attempts detected, followed by a successful login. Device experienced a successful brute force attack.                                                                                                                                                                                                                                                                                                              |
| High     | Binary Command Line                                    | Agent       | Linux binary called or executed from the command-line detected. This process may be legitimate activity, or may be an indication that your device is compromised.                                                                                                                                                                                                                                                                  |
| High     | Reverse shells                                         | Agent       | Analysis of host data detected use of a potential reverse shell. Reverse shell attacks are typically used to get a newly compromised machine to call back into a machine owned by the attacker.                                                                                                                                                                                                                                                                                          |
| High     | Disable on-host firewall                                       | Agent       | Possible manipulation of on-host firewall detected. Attackers will often disable the on-host firewall to exfiltrate data.                                                                                                                                                                                                                                                                                                                                    |
| High     | Web shell                                              | Agent       | Possible use of a web shell detected. Attackers typically upload a web shell to a compromised machine for the purpose of gaining persistence in your environment or for further exploitation.                                                                                                                                                                                                                                                                              |
| High     | Port forwarding                                        | Agent       | Detected initiation of port forwarding to an external IP address.                                                                                                                                                                                                                                                                                                                                                                       |
| High     | Possible attempt to disable Auditd logging detected    | Agent       | Linux Auditd system provides a way to track security-relevant system information. Auditd records as much information as possible about the events that are happening on your system.  Auditd information is crucial for mission-critical environments to be able to determine the violator of the security policy, and understand the actions they performed. Disabling auditd logging can halt discovery of violations of the security policies used on the system. |
| Medium   | Invalid SAS token signature                            | IoT Hub     | SAS token used by a device has an invalid signature. The SAS token does not match either the primary or secondary key.                                                                                                                                                                                                                                                                                                                               |
| Medium   | x.509 device certificate thumbprint mismatch           | IoT Hub     | X.509 device certificate thumbprint did not match configuration                                                                                                                                                                                                                                                                                                                                                                             |
| Medium   | X.509 certificate expired                              | IoT Hub     | X.509 device certificate has expired                                                                                                                                                                                                                                                                                                                                                                                                        |
| Medium   | Failed local login                                     | Agent       | A failed local login attempt to the device was detected.                                                                                                                                                                                                                                                                                                                                                                                     |
| Medium   | Crypto coin miner                                      | Agent       | Execution of a process normally associated with digital currency mining was detected.                                                                                                                                                                                                                                                                                                                                                        |
| Medium   | Known credential access tools                          | Agent       | Detected usage of a tool commonly associated with malicious actors attempting to access credentials.                                                                                                                                                                                                                                                                                                                                                             |
| Medium   | Crypto coin miner container image                      | Agent       | Container that runs known digital currency miner images was detected.                                                                                                                                                                                                                                                                                                                                                                     |
| Medium   | Known attack tool                                      | Agent       | Tool often associated with malicious users attacking other machines in some way was detected.                                                                                                                                                                                                                                                                                                                                              |
| Medium   | Access of htaccess file detected                       | Agent       | Analysis of host data detected possible manipulation of an htaccess file. Htaccess is a powerful configuration file that allows you to make multiple changes to a web server running the Apache Web software including basic redirect functionality, or for more advanced functions such as basic password protection. Attackers will often modify htaccess files on machines they have compromised to gain persistence.                    |
| Medium   | Behavior similar to common Linux bots detected         | Agent       | Execution of a process normally associated with common Linux botnets detected.                                                                                                                                                                                                                                                                                                                                                              |
| Medium   | Suspicious file Download Then Run Activity             | Agent       | Analysis of host data has detected a file being downloaded then run in the same command. This is a common technique attackers use to get malicious files onto victim machines.                                                                                                                                                                                                                                                              |
| Medium   | Potential loss of data detected                         | Agent       | Host data analysis detected a possible data egress (data loss) condition. Attackers typically often egress data from machines they have compromised.                                                                                                                                                                                                                                                                                                      |
| Medium   | Space after filename| Agent | Host data analysis indicates execution of a process with a suspicious extension. Suspicious extensions can trick users into thinking files are safe to open, and may indicate the presence of malware on the system.                                                                                                                                                                                                                   |
| Medium   | Exposed Docker daemon by TCP socket                    | Agent       | Machine logs indicate that your Docker daemon (dockerd) exposes a TCP socket. By default, Docker configuration, does not use encryption or authentication when a TCP socket is enabled. Your exposed TCP socket enables full access to anyone with access to the relevant port, to the Docker daemon.                                                                                                                                                          |
| Medium   | Behavior similar to Fairware ransomware detected       | Agent       | Host data analysis detected the execution of rm -rf commands applied to suspicious locations. Rm -rf recursively deletes files, and it is normally used on discrete folders. Currently, it is used in a location that could potentially remove many your data. Fairware ransomware is known to execute rm -rf commands in this folder.                                                                                                    |
| Medium   | Possible backdoor detected                             | Agent       | Analysis of host data detected a suspicious file was being downloaded and subsequently running of a suspicious file was originating from the download in your subscription. This activity has previously been associated with installation of a backdoor.                                                                                                                                                                                                                                                |
| Medium   | Local host reconnaissance detected                     | Agent       | Host data analysis detected execution of a command normally associated with common Linux bot reconnaissance.                                                                                                                                                                                                                                                                                                                         |
| Medium   | Potential overriding of common files                   | Agent       | Common executable overwritten on the device. Attackers typically overwrite common files as a way to hide their actions or to gain persistence in the environment.                                                                                                                                                                                                                                                                                              |
| Medium   | File downloads detected from a known malicious source   | Agent       | Analysis of device data has detected the download of a file from a known malware source.                                                                                                                                                                                                                                                                                                                                                    |
| Medium   | Privileged Container Detected                          | Agent       | Machine logs indicate that a privileged Docker container is running. A privileged container has a full access to the host's resources. If compromised, an attacker can use the privileged container to gain access to the host machine.                                                                                                                                                                                                     |
| Medium   | Behavior similar to ransomware detected                | Agent       | Analysis of the device data detected the execution of files that have resemblance of known ransomware that can prevents users from accessing their system or personal files and demands ransom payment in order to regain access.                                                                                                                                                                                                           |
| Medium   | Removal of system logs files detected                  | Agent       | Analysis of host data has detected suspicious removal of log files on the host.                                                                                                                                                                                                                                                                                                                                                             |
| Medium   | Mismatch between script interpreter and file extension | Agent       | Analysis of host data detected a mismatch between the script interpreter and the extension of the script file provided as input. This has frequently been associated with attacker script executions.                                                                                                                                                                                                                                       |
| Medium   | Suspicious compilation detected                        | Agent       | Analysis of host data detected suspicious compilation. Attackers will often compile exploits on a machine they have compromised to escalate privileges.                                                                                                                                                                                                                                                                                     |
| Medium   | Detected suspicious use of the nohup command           | Agent       | Analysis of host data has detected suspicious use of the nohup command on host. Attackers have been seen running the command nohup from a temporary directory to allow their executables to run in the background. It is not normal to see this command run on files located in a temporary directory.                                                                                                                                      |
| Medium   | Detected suspicious use of the useradd command         | Agent       | Analysis of host data has detected suspicious use of the useradd command on the device                                                                                                                                                                                                                                                                                                                                                      |
| Medium   | Suspicious IP address communication                    | Agent       | Detected suspicious IP address communication, based on analysis of the device data.                                                                                                                                                                                                                                                                                                                                                         |
| Low      | Expired SAS Token                                      | IoT Hub     | An expired SAS token was used by a device                                                                                                                                                                                                                                                                                                                                                                                                   |
| Low      | Device Silent                                          | Agent       | Device has not sent any telemetry data in the last 72 hours                                                                                                                                                                                                                                                                                                                                                                                 |
| Low      | Bash History Cleared                                   | Agent       | Bash History log cleared. Adversaries can hide their own commands from appear in the logs                                                                                                                                                                                                                                                                                                                                                   |
| Low      | Failed brute force                                      | Agent       | Multiple unsuccessful login attempts identified. An Attempted and failed brute force attack was made on the device.                                                                                                                                                                                                                                                                                                                                                  |

## Built-in alerts for IoT Hub

| Severity | Name                                                                         | Description                                                                                                                                                                                                                                                                                                                            |
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Medium   | New certificate added to an IoT Hub                                    |New certificate added to an IoT hub. If this addition was not made by an authorized party, it may indicate malicious activity.                                                                                                                                                                                                    |
| Medium   | Certificate deleted from an IoT Hub                                    | Certificate deleted from an IoT hub. If this action was not made by an authorized party, it may indicate malicious activity.                                                                                                                                                                                                |
| Medium   | Unsuccessful attempt detected to add a certificate to an IoT Hub     | Unsuccessful attempt to add a certificate to an IoT Hub detected. If this action was not made by an authorized party, it may indicate malicious activity.                                                                                                                                                                     |
| Medium   | Unsuccessful attempt detected to delete a certificate from an IoT Hub | Unsuccessful attempt to delete a certificate from an IoT Hub detected. If this action was not made by an authorized party, it may indicate malicious activity.                                                                                                                                                                |
| Low      | Attempt to add or edit a diagnostic setting of an IoT Hub detected    | Attempt to add or edit the diagnostic settings of an IoT Hub has been detected. Diagnostic settings enable you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised. If this action was not made by an authorized party, it may indicate malicious activity.  |
| Low      | Attempt to delete a diagnostic setting from an IoT Hub detected       | Attempt to delete the diagnostic settings of an IoT hub detected. Diagnostic setting enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised. If this action was not made by an authorized party, it may indicate on a malicious activity.       |
|

## See also

- [Overview](overview.md)
- [Access your security data](how-to-security-data-access.md)
- [Investigate a device](how-to-investigate-device.md)