---
title: Azure AD v2 JavaScript quickstart | Microsoft Docs
description: Learn how JavaScript applications can call an API that require access tokens by Azure Active Directory v2.0 endpoint
services: active-directory
documentationcenter: dev-center-name
author: andretms
manager: mtillman
editor: ''

ms.service: active-directory
ms.component: develop
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 09/21/2018
ms.author: andret
ms.custom: aaddev

#Customer intent: As an app developer, I want to learn how to get access tokens using the Azure AD v2.0 endpoint so that my JavaScript app can sign in personal and work and school accounts.
---

# Quickstart: Sign in users and acquire an access token from a JavaScript application

[!INCLUDE [active-directory-develop-applies-v2-msal](../../../includes/active-directory-develop-applies-v2-msal.md)]

In this quickstart, you'll learn how to use a code sample that demonstrates how a JavaScript single page application (SPA) can sign in personal accounts, work and school accounts, get an access token, and call the Microsoft Graph API.

![How the sample app generated by this Quickstart works](media/quickstart-v2-javascript/javascriptspa-intro.png)

> [!div renderon="docs"]
> ## Register your application and download your quickstart app
>
> ### Step 1: Register your application
>
> 1. Go to the [Microsoft Application Registration Portal](https://apps.dev.microsoft.com/portal/register-app) to register an application.
> 1. In the **Application Name** box, enter a name for your application.
> 1. Ensure that the **Guided Setup** check box is cleared, and then select **Create**.
> 1. Click **Add Platform**, then select **Web**.
> 1. Make sure **Allow Implicit Flow** is *checked*.
> 1. Under **Redirect URLs** add `http://localhost:30662/`.
> 1. Click **Save**.

> [!div class="sxs-lookup" renderon="portal"]
> #### Step 1: Configure your application in Azure portal
> For the code sample for this quickstart to work, you need to add a redirect URI as `http://localhost:30662/` and enable **Implicit Grant**.
> > [!div renderon="portal" id="makechanges" class="nextstepaction"]
> > [Make these changes for me]()
>
> > [!div id="appconfigured" class="alert alert-info"]
> > ![Already configured](media/quickstart-v2-javascript/green-check.png) Your application is configured with these attributes

#### Step 2: Download the project

You can choose one of these options suitable to your development environment.
* [Download the core project files - for a web server, such as Node.js](https://github.com/Azure-Samples/active-directory-javascript-graphapi-v2/archive/core.zip)
* [Download the Visual Studio project](https://github.com/Azure-Samples/active-directory-javascript-graphapi-v2/archive/VisualStudio.zip)

Extract the zip file to a local folder (for example, **C:\Azure-Samples**).

#### Step 3: Configure your JavaScript app

> [!div renderon="docs"]
> Edit `msalconfig.js` and replace `Enter_the_Application_Id_here` with the Application ID of the app you just registered. You can find the *Application ID* on the *Overview* page.

> [!div class="sxs-lookup" renderon="portal"]
> Edit `msalconfig.js` and replace msalconfig with:

```javascript
var msalconfig = {
    clientID: "Enter_the_Application_Id_here",
    redirectUri: location.origin
};
```
> [!NOTE]
> If you use [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/), the redirect URI will be set to `http://localhost:30662/` as it is configured in the code sample's project. If you use [Node.js](https://nodejs.org/en/download/) or any other web server, set the redirect URI to `http://localhost:30662/` and then configure the server to start listening on this port.
>

#### Step 4: Run the project

If using Visual Studio, press **F5** to run your project.

If using Node.js, on a command line you can run the following from the project's directory to start the server:
 ```batch
 npm install
 node server.js
 ```
Open a web browser and navigate to `http://localhost:30662/`. Click **Call Microsoft Graph API** button to start sign-in.


## More Information

### *msal.js*

MSAL is the library used to sign in users and request tokens used to access an API protected by Microsoft Azure Active Directory (Azure AD). The quickstart's *index.html* contains a reference to the library:

```html
<script src="https://secure.aadcdn.microsoftonline-p.com/lib/0.2.3/js/msal.min.js"></script>
````

Alternatively, if you have Node installed, you can download it through npm:

```batch
npm install msal
```

### MSAL initialization

The quickstart code also shows how to initialize the library:

```javascript
var userAgentApplication = new Msal.UserAgentApplication(msalconfig.clientID, null, loginCallback, {
    redirectUri: msalconfig.redirectUri
});
```

> |Where  |  |
> |---------|---------|
> |`ClientId`     |Application Id from the application registered in the Azure portal|
> |`authority`    |It is the authority URL. Passing *null* sets the default authority to `https://login.microsoftonline.com/common`. If your app is single-tenant (targeting accounts in one directory only), set this value to `https://login.microsoftonline.com/<tenant name or ID>`|
> |`loginCallBack`| Callback method called after the authentication redirects back to app|
> |`redirectUri`  |URL where users are redirected back after authentication with Azure AD|

### Sign in users

The following code snippet shows how to sign in users:

```javascript
userAgentApplication.loginRedirect(graphAPIScopes);
```

> |Where  |  |
> |---------|---------|
> | `graphAPIScopes`   | (Optional) Contains scopes being requested for user consent at login time (Ex: `[ "user.read" ]` for Microsoft Graph or `[ "api://<Application ID>/access_as_user" ]` for custom Web APIs). |

> [!TIP]
> Alternatively, you may want to use the `loginPopup` method to display a popup window to sign in the user.

### Request tokens

MSAL has three methods used to acquire tokens: `acquireTokenRedirect`, `acquireTokenPopup` and `acquireTokenSilent`:

#### Get a user token silently

The `acquireTokenSilent` method handles token acquisitions and renewal without any user interaction. After the `loginRedirect` or `loginPopup` method is executed for the first time, `acquireTokenSilent` is the method commonly used to obtain tokens that are used to access protected resources for subsequent calls. Calls to request or renew tokens are made silently.

```javascript
// Try to acquire the token used to query Graph API silently first:
userAgentApplication.acquireTokenSilent(graphAPIScopes)
```

> |Where  |  |
> |---------|---------|
> | `graphAPIScopes`   | Contains scopes being requested to be returned in the access token for API (Ex: `[ "user.read" ]` for Microsoft Graph or `[ "api://<Application ID>/access_as_user" ]` for custom Web APIs). |

#### Get a user token interactively

 There are situations where you need to force users to interact with Azure AD v2.0 endpoint. For example:
* Users may need to reenter their credentials because their password has expired
* Your application is requesting access to additional resource scopes that the user needs to consent to
* Two factor authentication is required

The usual recommended pattern for most applications is to call `acquireTokenSilent` first, then catch the exception and then call `acquireTokenRedirect` (or `acquireTokenPopup`) to start an interactive request.

Calling the `acquireTokenRedirect(scope)` results in redirecting users to the Azure AD v2.0 endpoint (or `acquireTokenPopup(scope)` results in a popup window) where users need to interact by either confirming their credentials, giving the consent to the required resource, or completing the two factor authentication.

```javascript
userAgentApplication.acquireTokenRedirect(graphAPIScopes);
```

## Next steps

For a more detailed step-by-step guide on how to build the application for this quickstart, try out the JavaScript tutorial below.

### Learn the steps to create the application for this quickstart

> [!div class="nextstepaction"]
> [Call Graph API tutorial](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-javascriptspa)

### Browse the MSAL repo for documentation, FAQ, issues, and more

> [!div class="nextstepaction"]
> [msal.js GitHub repo](https://github.com/AzureAD/microsoft-authentication-library-for-js)


[!INCLUDE [Help and support](../../../includes/active-directory-develop-help-support-include.md)]
