---
title: "Quickstart: Add sign-in with Microsoft to a Python web app"
description: In this quickstart, learn how a Python web app can sign in users, get an access token from the Microsoft identity platform, and call the Microsoft Graph API.
services: active-directory
author: cilwerner
manager: CelesteDG

ms.service: active-directory
ms.subservice: develop
ms.topic: quickstart
ms.workload: identity
ms.date: 01/18/2023
ms.author: cwerner
ms.custom: aaddev, devx-track-python, scenarios:getting-started, languages:Python
---

In this quickstart, you download and run a code sample that demonstrates how a Python web application can sign in users and call the Microsoft Graph API. Users with a personal Microsoft Account or an account in any Azure Active Directory (Azure AD) organization can sign into the application.

This diagram shows how the sample app works:

![Shows how the sample app generated by this quickstart works](../../media/quickstart-v2-python-webapp/topology.png)

1. The application uses the [`identity` package](https://pypi.org/project/identity/) to obtain an access token from the Microsoft Identity platform.
2. The access token is used as a bearer token to authenticate the user when calling the Microsoft Graph API.


## Prerequisites

- An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
- An Azure Active Directory (Azure AD) tenant. For more information on how to get an Azure AD tenant, see [how to get an Azure AD tenant.](/azure/active-directory/develop/quickstart-create-new-tenant)
- [Python 3.7+](https://www.python.org/downloads/)

## Step 1: Register your application

Follow these steps to register your application in the Azure portal:

1. Sign in to the <a href="https://portal.azure.com/" target="_blank">Azure portal</a>.
1. If you have access to multiple tenants, use the **Directory + subscription** filter :::image type="icon" source="../../media/common/portal-directory-subscription-filter.png" border="false"::: in the top menu to select the tenant in which you want to register an application.
1. Navigate to the Portal's [App registrations](https://go.microsoft.com/fwlink/?linkid=2083908) page.
1. Select **New registration**.
1. Enter a **Name** for your application, for example `python-webapp` . Users of your app might see this name, and you can change it later.
1. Under **Supported account types**, select **Accounts in any organizational directory and personal Microsoft accounts**.
1. Under **Redirect URIs**, select **Web** for the platform.
1. Enter a redirect URI of `http://localhost:5000/getAToken`. You can change that later if needed.
1. Select **Register**.
1. On the app **Overview** page, note the **Application (client) ID** value for later use.
1. Under **Manage**, select the **Certificates & secrets** and from the **Client secrets** section, select **New client secret**.
1. Type a key description (for instance app secret), leave the default expiration, and select **Add**.
1. Save the **Value** of the **Client Secret** in a safe location. You will need it to configure the code, and you can't retrieve it later.
1. Under **Manage**, select **API permissions** > **Add a permission**.
1. Ensure that the **Microsoft APIs** tab is selected.
1. From the *Commonly used Microsoft APIs* section, select **Microsoft Graph**.
1. From the **Delegated permissions** section, ensure that the right permissions are checked: **User.ReadBasic.All**. Use the search box if necessary.
1. Select the **Add permissions** button.

## Step 2: Download the project

You can either clone the repository:

```shell
git clone https://github.com/Azure-Samples/ms-identity-python-webapp.git
```

Or [download the repository as a .zip file](https://github.com/Azure-Samples/ms-identity-python-webapp/archive/master.zip) and extract the contents to a folder on your computer.

Optionally, if you use an integrated development environment, open the folder in your favorite IDE.

## Step 3: Configure the project

Go to the application folder.

Create an `.env` file in the root folder of the project using `.env.sample` as a guide.

```python
CLIENT_ID=<client id>
CLIENT_SECRET=<client secret>
TENANT_ID=<tenant id>
```

* Set the value of `CLIENT_ID` to the **Application (client) ID** for the registered application, available on the overview page.
* Set the value of `CLIENT_SECRET` to the client secret you created in **Certificates & Secrets** for the registered application.
* Set the value of `TENANT_NAME` to the **Directory (tenant) ID** of the registered application, also available on the overview page.

Those environment variables are referenced in the `app_config.py` file, but they are kept in a separate `.env` file to
keep them out of source control. The provided `.gitignore` file will prevent the `.env` file from being checked in.

## Step 4: Run the code sample

1. Create a virtual environment for the app:

    [!INCLUDE [Virtual environment setup](<../../../../app-service/includes/quickstart-python/virtual-environment-setup.md>)]

1. Install the requirements using pip:

    ```shell
    python3 -m pip install -r requirements.txt
    ```

2. Run the app from the command line, specifying the host and port to match the redirect URI:

    ```shell
    python3 -m flask run --host=localhost --port=5000
    ```

   > [!IMPORTANT]
   > This quickstart application uses a client secret to identify itself as confidential client. Because the client secret is added as a plain-text to your project files, for security reasons, it is recommended that you use a certificate instead of a client secret before considering the application as production application. For more information on how to use a certificate, see [these instructions](../../active-directory-certificate-credentials.md).


[!INCLUDE [Help and support](../../../../../includes/active-directory-develop-help-support-include.md)]

## Next steps

Learn more about web apps that sign in users in our multi-part scenario series.

> [!div class="nextstepaction"]
> [Scenario: Web app that signs in users](../../scenario-web-app-sign-user-overview.md)

> [!div class="nextstepaction"]
> [Scenario: Web app that calls web APIs](../../scenario-web-app-call-api-overview.md)
