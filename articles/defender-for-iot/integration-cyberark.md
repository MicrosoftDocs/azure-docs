---
title: About the CyberArk integration
description: CyberX delivers the only ICS and IIoT cybersecurity platform built by blue-team experts with a track record defending critical national infrastructure — and the only platform with patented ICS-aware threat analytics and machine learning.
author: mlottner
ms.author: mlottner
ms.date: 08/31/2020
ms.topic: article
ms.service: azure
---
# About the CyberArk integration

CyberX delivers the only ICS and IIoT cybersecurity platform built by blue-team experts with a track record defending critical national infrastructure — and the only platform with patented ICS-aware threat analytics and machine learning.

Threat actors are leveraging compromised remote access credentials to access critical infrastructure networks via remote desktop and VPN connections. By using trusted connections, this approach easily bypasses any OT perimeter security. Credentials are typically stolen from privileged users — such as control engineers and third-party maintenance personnel — who require remote access to perform daily tasks.

The CyberX integration with CyberARK. These bridged platforms enable TBD

### Use cases

- Reduce OT Risk from Unauthorized Remote Access
- Provide Continuous Monitoring & Privileged Access Security for OT
- Enhance incident response, threat hunting & threat modeling

#### Getting more information

For CyberX support and troubleshooting, contact: [support@cyberx-labs.com](mailto:support@cyberx-labs.com).

For more information about CyberX capabilities, features and tools, refer to [www.cyberx-labs.com](https://www.cyberx-labs.com).

For more information about CyberArk requirements, refer to

## Use cases 

### Real-time alerting 

Whenever the CyberX platform identifies remote sessions that have not been authorized by PSM, it will issue an “Unauthorized Remote Session” alert as shown below. To facilitate immediate investigation, the alert also shows the IP addresses and names of the source and destination devices.

:::image type="content" source="media/integration-cyberark/image3.png" alt-text="“Unauthorized Remote Session” alert":::

### Event timeline 

Whenever PSM authorizes a remote connection, it will be documented and visible in the CyberX Event Log page, which shows a timeline of all alerts and notifications. This acts as an additional audit trail, as seen below:

:::image type="content" source="media/integration-cyberark/image4.png" alt-text="Event Log":::

### Auditing & forensics

Administrators can also audit and investigate remote access sessions by querying the CyberX platform via its built-in data mining interface. This can be used to identify all remote access connections that have occurred including forensic details such as From/To devices, protocols (RDP, SSH, etc.), Source/Destination users, time-stamps, and whether the sessions were authorized using PSM.

:::image type="content" source="media/integration-cyberark/image5.png" alt-text="Data mining interface":::

### Integration system requirements

This section describes integration system requirements:

- **CyberX Requirements**
- **CyberARK Requirements**
  - CyberARK version 2.0
- **Network Requirements**
  - Verify that the CyberX appliance has access to TBD
  - Verify that you have CLI access to all CyberX appliances in your enterprise.

## How it works 

The CyberX appliance is connected to the OT network via a SPAN port (mirror port) on network devices such as switches and routers. A network TAP can also be used. This is achieved via one-way (inbound) connections to dedicated network interfaces on the CyberX appliance.

A dedicated network interface is also provided in the CyberX appliance for centralized management and API access. This interface is also used for communicating with the CyberArk PSM solution.

The CyberArk PSM solution is deployed in the data center of the organization to manage privileged users and secure remote access connections.

:::image type="content" source="media/integration-cyberark/image6.png" alt-text="CyberArk PSM solution deployment":::

The integration between the CyberX platform and CyberArk PSM is performed via syslog messages. These messages are sent by the PSM solution to the CyberX platform, notifying CyberX of any remote sessions or verification failures.

Once the CyberX platform receives these messages from PSM, it correlates them with the data it sees in the network, thus validating that any remote access connections to the network were generated by the PSM solution and not by a rogue or unauthorized user.

## CyberArk setup

This section describes how to:

- TBD

### Set up communication with CyberArk

TBD

### Define the PSM configuration

TBD

To configure PSM:

1. Configure syslog forwarding:
   - Open c:\Program Files\PrivateArk\Server\dbparam.xml file
   - Add the following parameters:
   ```
   [SYSLOG]

   UseLegacySyslogFormat=Yes

   SyslogTranslatorFile=Syslog\CyberX.xsl

   SyslogServerIP=<CyberX Server IP>

   SyslogServerProtocol=UDP

   SyslogMessageCodeFilter=319,320,295,378,380
   ```
   - Save the file and close it
1. Place the CyberX syslog configuration file (CyberX.xsl) in c:\Program Files\PrivateArk\Server\Syslog\CyberX.xsl
1. Restart the vault server:
   - Open Server Central Administration (Icon: PrivateArk Server)
   :::image type="content" source="media/integration-cyberark/image7.png" alt-text="Server Central Administration":::
   - Click on Stop Traffic Light (Server Stop)
   - Click on Start Traffic Light (Server Start)

## CyberX platform configuration

By default, the Syslog Server listens on the IP of the system using port 514 UDP. This default can be updated.

To configure the CyberX platform:

###  Starting the syslog server
   - In the CyberX console, navigate to the System Settings screen
   - Toggle on the "Syslog Server" to start it
   :::image type="content" source="media/integration-cyberark/image8.png" alt-text="Server status":::

### Changing the port

If you want to change the port, log in to the system via the CLI, and navigate to /var/cyberx/properties/syslog.properties, and change the following: listener: 514/udp

### Halting the Integration

To stop the integration, toggle off the "Syslog Server

:::image type="content" source="media/integration-cyberark/image8.png" alt-text="Server status":::

## Set up the CyberX appliances

This section describes how to set up CyberX appliances to communicate with pxGrid. The configuration should be carried out on all CyberX appliances that will inject data to Cisco ISE.

To set up appliances:

1. TBD

## View and manage detections in XX

## Troubleshooting and logs 

Logs can be found in:

- /var/cyberx/logs/pxgrid.log
- /var/cyberx/logs/core.log

### From other resources:

#### Phase 1 - Integration for user activity via Syslog

**Use case** - CyberX sees all real-time communication in the network, thus can validate that every remote access activity is used only by CyberArk, in case CyberX sees a remote access connection that was not initiated from CyberArk it can alert it to the SOC for further investigation.

**Integration Details** - CyberArk's product (PSM) will forward XSense syslog messages, notifying about remote sessions or verification failures.

**Integration Status** - Done. Verified during the integration checks

#### Phase 2 - Accessing recorded sessions from the recordings vault

**Use case** - CyberX will suggest the customer to view recorded session to devices in his network, retrieved from CyberArk vault.

**Integration Details** - CyberX will use PACLI (CyberArk tool for communicating with their product) to gather the recording files from the CyberArk vault.

**Integration Status:** - All technical information has been gathered, in development stages.

#### Phase 3 - Initiating connections

Krumer: Add AIM (Application Identity Manager) integration to gather credentials for PLCs and query device so all credentials are in the CyberArk

**Use Case** - A redirect from CyberX to CyberArk's platform to initiate a secured remote session.

**Integration Details** – Yet to be determined.

**Integration Status:** - Require additional information from CyberArk product team.
