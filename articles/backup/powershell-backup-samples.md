---
title: PowerShell Samples
description: This article provides links to PowerShell script samples that use Azure Backup to back up and restore data.
ms.topic: sample
ms.date: 06/23/2021
ms.custom: mvc
author: AbhishekMallick-MS
ms.author: v-abhmallick
---
# Azure Backup PowerShell samples

The following table links to PowerShell script samples that use Azure Backup to back up and restore data.

| Script | Description |
|---|---|
| [Back up an encrypted virtual machine to Azure](./scripts/backup-powershell-sample-backup-encrypted-vm.md) | Back up all data on the encrypted virtual machine.|
| [Find Registered Storage Account](./scripts/backup-powershell-script-find-recovery-services-vault.md) | Find the Recovery Services vault where the storage account is registered |
| [Disable Soft delete for File Shares in a Storage Account](./scripts/disable-soft-delete-for-file-shares.md) | Disable Soft delete for File Shares in a Storage Account|
| [Undelete accidentally deleted File share](./scripts/backup-powershell-script-undelete-file-share.md) | Undelete accidentally deleted File share |
| [Install the latest MARS agent](./scripts/install-latest-microsoft-azure-recovery-services-agent.md) | Install the latest MARS agent on your on-premises Windows server. |
| [Register MARS agent](./scripts/register-microsoft-azure-recovery-services-agent.md) | Register your on-premises Windows server or client machine with a Recovery Services vault. |
| [Set file and folder backup policy for on-premises Windows server.](./scripts/set-file-folder-backup-policy.md) | Create a new policy or modify the current file and folder backup policy. |
| [Set system state backup policy for on-premises Windows server.](./scripts/set-system-state-backup-policy.md) | Create a new backup policy or modify the current system state backup policy. | 
| [Configure backup for on-premises Windows server.](./scripts/microsoft-azure-recovery-services-powershell-all.md)  | Configure backup for your on-premises Windows server. |

