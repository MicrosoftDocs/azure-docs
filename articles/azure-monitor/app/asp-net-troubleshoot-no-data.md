---
title: Troubleshooting no data - Application Insights for .NET
description: Not seeing data in Azure Application Insights? Try here.
services: application-insights
documentationcenter: .net
author: mrbullwinkle
manager: carmonm

ms.assetid: e231569f-1b38-48f8-a744-6329f41d91d3
ms.service: application-insights
ms.workload: mobile
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 07/23/2018
ms.author: mbullwin

---
# Troubleshooting no data - Application Insights for .NET
## Some of my telemetry is missing
*In Application Insights, I only see a fraction of the events that are being generated by my app.*

* If you are consistently seeing the same fraction, it's probably due to adaptive [sampling](../../azure-monitor/app/sampling.md). To confirm this, open Search (from the overview blade) and look at an instance of a Request or other event. At the bottom of the properties section click "..." to get full property details. If Request Count > 1, then sampling is in operation.
* Otherwise, it's possible that you're hitting a [data rate limit](../../azure-monitor/app/pricing.md#limits-summary) for your pricing plan. These limits are applied per minute.

*I'm experiencing data loss randomly.*

* Check if you are experiencing data loss at [Telemetry Channel](telemetry-channels.md#does-the-application-insights-channel-guarantee-telemetry-delivery-if-not-what-are-the-scenarios-in-which-telemetry-can-be-lost)

* Check for any known issues in Telemetry Channel [Github repo](https://github.com/Microsoft/ApplicationInsights-dotnet/issues)

*I'm experiencing data loss in Console App or on Web App when app is about to stop.*

* SDK channel keeps telemetry in buffer, and sends them in batches. If the application is shutting down, you may need to explicitly call [Flush()](api-custom-events-metrics.md#flushing-data). Behavior of `Flush()` depends on the actual [channel](telemetry-channels.md#built-in-telemetry-channels) used.

## No data from my server
*I installed my app on my web server, and now I don't see any telemetry from it. It worked OK on my dev machine.*

* Probably a firewall issue. [Set firewall exceptions for Application Insights to send data](../../azure-monitor/app/ip-addresses.md).
* IIS Server might be missing some prerequisites: .NET Extensibility 4.5, and ASP.NET 4.5.

*I [installed Status Monitor](../../azure-monitor/app/monitor-performance-live-website-now.md) on my web server to monitor existing apps. I don't see any results.*

* See [Troubleshooting Status Monitor](../../azure-monitor/app/monitor-performance-live-website-now.md#troubleshoot).

## <a name="q01"></a>No 'Add Application Insights' option in Visual Studio
*When I right-click an existing project in Solution Explorer, I don't see any Application Insights options.*

* Not all types of .NET project are supported by the tools. Web and WCF projects are supported. For other project types such as desktop or service applications, you can still [add an Application Insights SDK to your project manually](../../azure-monitor/app/windows-desktop.md).
* Make sure you have [Visual Studio 2013 Update 3 or later](https://docs.microsoft.com/visualstudio/releasenotes/vs2013-update3-rtm-vs). It comes pre-installed with Developer Analytics tools, which provide the Application Insights SDK.
* Select **Tools**, **Extensions and Updates** and check that **Developer Analytics Tools** is installed and enabled. If so, click **Updates** to see if there's an update available.
* Open the New Project dialog and choose ASP.NET Web application. If you see the Application Insights option there, then the tools are installed. If not, try uninstalling and then re-installing the Developer Analytics Tools.

## <a name="q02"></a>Adding Application Insights failed
*When I try to add Application Insights to an existing project, I see an error message.*

Likely causes:

* Communication with the Application Insights portal failed; or
* There is some problem with your Azure account;
* You only have [read access to the subscription or group where you were trying to create the new resource](../../azure-monitor/app/resources-roles-access-control.md).

Fix:

* Check that you provided sign-in credentials for the right Azure account.
* In your browser, check that you have access to the [Azure portal](https://portal.azure.com). Open Settings and see if there is any restriction.
* [Add Application Insights to your existing project](../../azure-monitor/app/asp-net.md): In Solution Explorer, right click your project and choose "Add Application Insights."

## <a name="emptykey"></a>I get an error "Instrumentation key cannot be empty"
Looks like something went wrong while you were installing Application Insights or maybe a logging adapter.

In Solution Explorer, right-click your project and choose **Application Insights > Configure Application Insights**. You'll get a dialog that invites you to sign in to Azure and either create an Application Insights resource, or re-use an existing one.

## <a name="NuGetBuild"></a> "NuGet package(s) are missing" on my build server
*Everything builds OK when I'm debugging on my development machine, but I get a NuGet error on the build server.*

Please see [NuGet Package Restore](https://docs.nuget.org/Consume/Package-Restore)
and [Automatic Package Restore](https://docs.nuget.org/Consume/package-restore/migrating-to-automatic-package-restore).

## Missing menu command to open Application Insights from Visual Studio
*When I right-click my project Solution Explorer, I don't see any Application Insights commands, or I don't see an Open Application Insights command.*

Likely causes:

* If you created the Application Insights resource manually, or if the project is of a type that isn't supported by the Application Insights tools.
* The Developer Analytics tools are disabled in your Visual Studio.
* Your Visual Studio is older than 2013 Update 3.

Fix:

* Make sure your Visual Studio version is 2013 update 3 or later.
* Select **Tools**, **Extensions and Updates** and check that **Developer Analytics tools** is installed and enabled. If so, click **Updates** to see if there's an update available.
* Right-click your project in Solution Explorer. If you see the command **Application Insights > Configure Application Insights**, use it to connect your project to the resource in the Application Insights service.

Otherwise, your project type isn't directly supported by the Developer Analytics tools. To see your telemetry, sign in to the [Azure portal](https://portal.azure.com), choose Application Insights on the left navigation bar, and select your application.

## 'Access denied' on opening Application Insights from Visual Studio
*The 'Open Application Insights' menu command takes me to the Azure portal, but I get an 'access denied' error.*

The Microsoft sign-in that you last used on your default browser doesn't have access to [the resource that was created when Application Insights was added to this app](../../azure-monitor/app/asp-net.md). There are two likely reasons:

* You have more than one Microsoft account - maybe a work and a personal Microsoft account? The sign-in that you last used on your default browser was for a different account than the one that has access to [add Application Insights to the project](../../azure-monitor/app/asp-net.md).
  * Fix: Click your name at top right of the browser window, and sign out. Then sign in with the account that has access. Then on the left navigation bar, click Application Insights and select your app.
* Someone else added Application Insights to the project, and they forgot to give you [access to the resource group](../../azure-monitor/app/resources-roles-access-control.md) in which it was created.
  * Fix: If they used an organizational account, they can add you to the team; or they can grant you individual access to the resource group.

## 'Asset not found' on opening Application Insights from Visual Studio
*The 'Open Application Insights' menu command takes me to the Azure portal, but I get an 'asset not found' error.*

Likely causes:

* The Application Insights resource for your application has been deleted; or
* The instrumentation key was set or changed in ApplicationInsights.config by editing it directly, without updating the project file.

The instrumentation key in ApplicationInsights.config controls where the telemetry is sent. A line in the project file controls which resource is opened when you use the command in Visual Studio.

Fix:

* In Solution Explorer, right-click the project and choose Application Insights, Configure Application Insights. In the dialog, you can either choose to send telemetry to an existing resource, or create a new one. Or:
* Open the resource directly. Sign in to [the Azure portal](https://portal.azure.com), click Application Insights on the left navigation bar, and then select your app.

## Where do I find my telemetry?
*I signed in to the [Microsoft Azure portal](https://portal.azure.com), and I'm looking at the Azure home dashboard. So where do I find my Application Insights data?*

* On the left navigation bar, click Application Insights, then your app name. If you don't have any projects there, you need to [add or configure Application Insights in your web project](../../azure-monitor/app/asp-net.md).  
  There you'll see some summary charts. You can click through them to see more detail.
* In Visual Studio, while you're debugging your app, click the Application Insights button.

## <a name="q03"></a> No server data (or no data at all)
*I ran my app and then opened the Application Insights service in Microsoft Azure, but all the charts show 'Learn how to collect...' or 'Not configured.'* Or, *only Page View and user data, but no server data.*

* Run your application in debug mode in Visual Studio (F5). Use the application so as to generate some telemetry. Check that you can see events logged in the Visual Studio output window.  
  ![](./media/asp-net-troubleshoot-no-data/output-window.png)
* In the Application Insights portal, open [Diagnostic Search](../../azure-monitor/app/diagnostic-search.md). Data usually appears here first.
* Click the Refresh button. The blade refreshes itself periodically, but you can also do it manually. The refresh interval is longer for larger time ranges.
* Check the instrumentation keys match. On the main blade for your app in the Application Insights portal, in the **Essentials** drop-down, look at **Instrumentation key**. Then, in your project in Visual Studio, open ApplicationInsights.config and find the `<instrumentationkey>`. Check that the two keys are equal. If not:  
  * In the portal, click Application Insights and look for the app resource with the right key; or
  * In Visual Studio Solution Explorer, right-click the project and choose Application Insights, Configure. Reset the app to send telemetry to the right resource.
  * If you can't find the matching keys, check that you are using the same sign-in credentials in Visual Studio as in to the portal.
* In the [Microsoft Azure home dashboard](https://portal.azure.com), look at the Service Health map. If there are some alert indications, wait until they have returned to OK and then close and re-open your Application Insights application blade.
* Check also [our status blog](https://blogs.msdn.microsoft.com/servicemap-status/).
* Did you write any code for the [server-side SDK](../../azure-monitor/app/api-custom-events-metrics.md) that might change the instrumentation key in `TelemetryClient` instances or in `TelemetryContext`? Or did you write a [filter or sampling configuration](../../azure-monitor/app/api-filtering-sampling.md) that might be filtering out too much?
* If you edited ApplicationInsights.config, carefully check the configuration of [TelemetryInitializers and TelemetryProcessors](../../azure-monitor/app/api-filtering-sampling.md). An incorrectly-named type or parameter can cause the SDK to send no data.

## <a name="q04"></a>No data on Page Views, Browsers, Usage
*I see data in Server Response Time and Server Requests charts, but no data in Page View Load time, or in the Browser or Usage blades.*

The data comes from scripts in the web pages. 

* If you added Application Insights to an existing web project, [you have to add the scripts by hand](../../azure-monitor/app/javascript.md).
* Make sure Internet Explorer isn't displaying your site in Compatibility mode.
* Use the browser's debug feature (F12 on some browsers, then choose Network) to verify that data is being sent to `dc.services.visualstudio.com`.

## No dependency or exception data
See [dependency telemetry](../../azure-monitor/app/asp-net-dependencies.md) and [exception telemetry](asp-net-exceptions.md).

## No performance data
Performance data (CPU, IO rate, and so on) is available for [Java web services](../../azure-monitor/app/java-collectd.md), [Windows desktop apps](../../azure-monitor/app/windows-desktop.md), [IIS web apps and services if you install status monitor](../../azure-monitor/app/monitor-performance-live-website-now.md), and [Azure Cloud Services](../../azure-monitor/app/app-insights-overview.md). you'll find it under Settings, Servers.

## No (server) data since I published the app to my server
* Check that you actually copied all the Microsoft. ApplicationInsights DLLs to the server, together with Microsoft.Diagnostics.Instrumentation.Extensions.Intercept.dll
* In your firewall, you might have to [open some TCP ports](../../azure-monitor/app/ip-addresses.md).
* If you have to use a proxy to send out of your corporate network, set [defaultProxy](https://msdn.microsoft.com/library/aa903360.aspx) in Web.config
* Windows Server 2008: Make sure you have installed the following updates: [KB2468871](https://support.microsoft.com/kb/2468871), [KB2533523](https://support.microsoft.com/kb/2533523), [KB2600217](https://support.microsoft.com/kb/2600217).

## I used to see data, but it has stopped
* Check the [status blog](https://blogs.msdn.com/b/applicationinsights-status/).
* Have you hit your monthly quota of data points? Open the Settings/Quota and Pricing to find out. If so, you can upgrade your plan, or pay for additional capacity. See the [pricing scheme](https://azure.microsoft.com/pricing/details/application-insights/).

## I don't see all the data I'm expecting
If your application sends a lot of data and you are using the Application Insights SDK for ASP.NET version 2.0.0-beta3 or later, the [adaptive sampling](../../azure-monitor/app/sampling.md) feature may operate and send only a percentage of your telemetry.

You can disable it, but this is not recommended. Sampling is designed so that related telemetry is correctly transmitted, for diagnostic purposes.

## Client IP address is 0.0.0.0

On February 5 2018, we announced that we removed logging of the Client IP address. This does not affect Geo Location.

> [!NOTE]
> If you need the first 3 octets of the IP address, you can use a [telemetry initializer](https://docs.microsoft.com/azure/application-insights/app-insights-api-filtering-sampling#add-properties-itelemetryinitializer) to add a custom attribute.
> This does not affect data collected prior to February 5, 2018.

## Wrong geographical data in user telemetry
The city, region, and country dimensions are derived from IP addresses and aren't always accurate. These IP addresses are processed for location first and then changed to 0.0.0.0 to be stored.

## Exception "method not found" on running in Azure Cloud Services
Did you build for .NET 4.6? 4.6 is not automatically supported in Azure Cloud Services roles. [Install 4.6 on each role](../../cloud-services/cloud-services-dotnet-install-dotnet.md) before running your app.

## Troubleshooting Logs

Follow these instructions to capture troubleshooting logs for your framework.

### .NET Framework

1. Install the [Microsoft.AspNet.ApplicationInsights.HostingStartup](https://www.nuget.org/packages/Microsoft.AspNet.ApplicationInsights.HostingStartup) package from NuGet. The version you install must match the current installed version of `Microsoft.ApplicationInsighs`

2. Modify your applicationinsights.config file to include the following:

    ```xml
    <TelemetryModules>
      <Add Type="Microsoft.ApplicationInsights.Extensibility.HostingStartup.FileDiagnosticsTelemetryModule, Microsoft.AspNet.ApplicationInsights.HostingStartup">
        <Severity>Verbose</Severity>
        <LogFileName>mylog.txt</LogFileName>
        <LogFilePath>C:\\SDKLOGS</LogFilePath>
      </Add>
    </TelemetryModules>
    ```
    Your application must have Write permissions to the configured location

3. Restart process so that these new settings are picked up by SDK

4. Revert these changes when you are finished.

### .NET Core

1. Install the [Microsoft.AspNet.ApplicationInsights.HostingStartup](https://www.nuget.org/packages/Microsoft.AspNet.ApplicationInsights.HostingStartup) package from NuGet. The version you install must match the current installed version of `Microsoft.ApplicationInsights`

The latest version of Microsoft.ApplicationInsights.AspNetCore is 2.7.1, and it refers to Microsoft.ApplicationInsights version 2.10. Hence the version of Microsoft.AspNet.ApplicationInsights.HostingStartup to be installed should be 2.10.0

2. Modify `ConfigureServices` method in your `Startup.cs` class.:

    ```csharp
    services.AddSingleton<ITelemetryModule, FileDiagnosticsTelemetryModule>();
    services.ConfigureTelemetryModule<FileDiagnosticsTelemetryModule>( (module, options) => {
        module.LogFilePath = "C:\\SDKLOGS";
        module.LogFileName = "mylog.txt";
        module.Severity = "Verbose";
    } );
    ```
    Your application must have Write permissions to the configured location

3. Restart process so that these new settings are picked up by SDK

4. Revert these changes when you are finished.


## <a name="PerfView"></a> Collect logs with PerfView
[PerfView](https://github.com/Microsoft/perfview) is a free diagnostics and performance-analysis tool that help isolate CPU, memory, and other issues by collecting and visualizing diagnostics information from many sources.

The Application Insights SDK log EventSource self-troubleshooting logs that can be captured by PerfView.

To collect logs, download PerfView and run this command:
```cmd
PerfView.exe collect -MaxCollectSec:300 -NoGui /onlyProviders=*Microsoft-ApplicationInsights-Core,*Microsoft-ApplicationInsights-Data,*Microsoft-ApplicationInsights-WindowsServer-TelemetryChannel,*Microsoft-ApplicationInsights-Extensibility-AppMapCorrelation-Dependency,*Microsoft-ApplicationInsights-Extensibility-AppMapCorrelation-Web,*Microsoft-ApplicationInsights-Extensibility-DependencyCollector,*Microsoft-ApplicationInsights-Extensibility-HostingStartup,*Microsoft-ApplicationInsights-Extensibility-PerformanceCollector,*Microsoft-ApplicationInsights-Extensibility-PerformanceCollector-QuickPulse,*Microsoft-ApplicationInsights-Extensibility-Web,*Microsoft-ApplicationInsights-Extensibility-WindowsServer,*Microsoft-ApplicationInsights-WindowsServer-Core,*Microsoft-ApplicationInsights-Extensibility-EventSourceListener,*Microsoft-ApplicationInsights-AspNetCore
```

You can modify these parameters as needed:
- **MaxCollectSec**. Set this parameter to prevent PerfView from running indefinitely and affecting the performance of your server.
- **OnlyProviders**. Set this parameter to only collect logs from the SDK. You can customize this list based on your specific investigations. 
- **NoGui**. Set this parameter to collect logs without the Gui.


For more information,
- [Recording performance traces with PerfView](https://github.com/dotnet/roslyn/wiki/Recording-performance-traces-with-PerfView).
- [Application Insights Event Sources](https://github.com/microsoft/ApplicationInsights-Home/tree/master/Samples/ETW)

## Still not working...
* [Application Insights forum](https://social.msdn.microsoft.com/Forums/vstudio/en-US/home?forum=ApplicationInsights)
