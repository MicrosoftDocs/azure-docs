---
title: Monitor Azure virtual machines with Azure Monitor
description: Describes how to collect and analyze monitoring data from virtual machines in Azure using Azure Monitor.
ms.service:  azure-monitor
ms.subservice: logs
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 10/08/2019

---

# Monitoring Azure virtual machines with Azure Monitor
Virtual machines can be monitored for availability and performance with Azure Monitor like any [other Azure resource](monitor-azure-resource.md), but they're unique from other resources since you also need to monitor the guest operating and system and the workloads that run in it. This article describes how to use Azure Monitor to collect monitoring data from Azure VMs and to analyze and alert on this data to maintain the health and performance of your virtual machines. 

> [!NOTE]
> This article provides a complete overview of the concepts and options for monitoring virtual machines in Azure Monitor. To start monitoring your virtual machines quickly without focusing on the underlying concepts, see [Quickstart: Monitor an Azure virtual machine with Azure Monitor](../learn/quick-monitor-azure-vm.md).

## What is Azure Monitor?
Azure Monitor is a full stack monitoring service in Azure that provides a complete set of features to monitor your Azure resources in addition to resources in other clouds and on-premises. The [Azure Monitor data platform](../platform/data-platform.md) collects data into [logs](../platform/data-platform-logs.md) and [metrics](../platform/data-platform-metrics.md) where they can be analyzed together using a complete set of monitoring tools as described in the following sections.

- [What can you do with Azure Monitor Metrics?](../platform/data-platform-metrics.md#what-can-you-do-with-azure-monitor-metrics)
- [What can you do with Azure Monitor Logs?](../platform/data-platform-logs.md#what-can-you-do-with-azure-monitor-logs)

As soon as you create an Azure resource, Azure Monitor is enabled and starts collecting metrics and activity logs which you can [view and analyze in the Azure portal](#monitoring-in-the-azure-portal). With some configuration, you can gather additional monitoring data and enable additional features. See [Monitoring Data](#monitoring-data) below for details on any configuration requirements.


## Differences from other Azure resources
[Monitoring Azure resources with Azure Monitor](monitor-azure-resource.md) describes the monitoring data generated by Azure resources and how you can use the features of Azure Monitor to analyze and alert on this data. You can collect and act on the same monitoring data from Azure virtual machines with the following differences:

- [Platform metrics](../platform/data-platform-metrics.md) are collected automatically collected for virtual machines but only for the [virtual machine host](#host-monitoring). You need an agent to collect performance data from the guest operating system.
- Virtual machines don't generate [resource logs](platform-logs-overview.md) which provide insight into operations that were performed within an Azure resource. You need an agent to log data from the guest operating system.
- You can create [diagnostic settings](../platform/diagnostic-settings.md) for a virtual machine to send metrics to other destinations such as storage and event hubs, but you can't configure these diagnostic settings in the Azure portal. The **Diagnostics setting** option in the virtual machine menu in the portal is for configuring the [diagnostics extension](), not for configuring diagnostic settings.


## Host monitoring
Virtual machines in Azure generate the same Activity log and platform metrics for the host as other Azure resources as described in [Monitoring data](monitor-azure-resource.md#monitoring-data). 

- [Platform metrics](../platform/data-platform-metrics.md) - Numerical values that are automatically collected at regular intervals and describe some aspect of a resource at a particular time. Platform metrics are collected for the virtual machine host, but you require the Azure Diagnostics extension to collect metrics for the guest operating system.
- [Activity log](../platform/platform-logs-overview.md) - Provides insight into the operations on each Azure resource in the subscription from the outside (the management plane). For a virtual machine, this includes such information as when it was started and when any configuration changes were made to the host.


## Agents
To collect data from the guest operating system of a virtual machine, you require an agent. The agent runs locally on each virtual machine and sends data to Azure Monitor. Multiple agents are available for Azure Monitor with each collecting different data and writing data to different locations. Which agents you use will depend on your particular requirements. Get a detailed comparison of the different agents at [Overview of the Azure Monitor agents](../platform/agents-overview/md). 

- [Log Analytics agent](../platform/agents-overview#log-analytics-agent.md) - Available for virtual machines in Azure, other cloud environments, and on-premises. Collects data to Azure Monitor Logs. Supports Azure Monitor for VMs and monitoring solutions. This is the same agent used for System Center Operations Manager.
- [Dependency agent](../platform/agents-overview#dependency-agent.md) - Collects data about the processes running on the virtual machine and their dependencies. Relies on the Log Analytics agent and supports Azure Monitor for VMs and the Service Map solution.
- [Azure Diagnostic extension](../platform/agents-overview#azure-diagnostic-extension.md) - Available for Azure Monitor virtual machines only. Can collect data to mulitple locations but primarily used to collect guest performance data into Azure Monitor Metrics.
- [Telegraf agent](../platform/collect-custom-metrics-linux-telegraf.md) - Collect performance data from Linux VMs into Azure Monitor Metrics.



## Monitoring data
Resources in Azure generate [logs](../platform/data-platform-logs.md) and [metrics](../platform/data-platform-metrics.md) shown the following diagram. 

![Overview](media/monitor-vm-azure/logs-metrics.png)


## Azure Monitor for VMs (preview)
[Azure Monitor for VMs](vminsights-overview.md) is an [insight](insights-overview.md) in Azure Monitor that is your primary tool for monitoring virtual machines in Azure Monitor. It provides the following additional value over standard Azure Monitor features.

- Simpified onboarding of Log Analytics agent and Dependency agent to enable monitoring of a virtual machine guest operating system and workloads. 
- Pre-defined trending performance charts and workbooks that allow you to analyze core performance metrics from the guest VM operating system.
- Dependency map that displays processes running on each VM the interconnected components with the VM from various resource groups and subscriptions.

See [Enable Azure Monitor for VMs (preview) overview](vminsights-enable-overview.md) for details on enabling Azure monitor for VMs.


## Log 




## Diagnostics extension
Azure Monitor for VMs is based on the Log Analytics agent that collects data into a Log Analytics workspace. The Diagnostics extension that you can enable in addition to the Log Analytics agent, but only enable it if you require the following functionality:

- Collect performance data from the guest operating system into [Azure Monitor Metrics](../platform/data-platform-metrics.md) to analyze it with [metrics explorer](../platform/metrics-getting-started.md) and [metrics alerts](../platform/alerts-metric.md).
- Send events and performance data outside of Azure Monitor using Azure Event Hubs.
- Send events and performance data to Azure Storage data for archiving.



 

[Cloud Monitoring Guide](https://docs.microsoft.com/azure/cloud-adoption-framework/manage/monitor/cloud-models-monitor-overview)

## Next steps

* See [Supported services, schemas, and categories for Azure Resource Logs](../platform/diagnostic-logs-schema.md) for details of resource logs for different Azure services.  
