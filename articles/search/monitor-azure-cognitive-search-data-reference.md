---
title: Azure Cognitive Search monitoring data reference
description: Log and metrics reference for monitoring data from Azure Cognitive Search.

manager: nitinme
author: HeidiSteen
ms.author: heidist

ms.service: cognitive-search
ms.topic: reference
ms.date: 11/24/2021
ms.custom: subject-monitoring
---

# Azure Cognitive Search monitoring data reference

This article provides a reference of log and metric data collected to analyze the performance and availability of Azure Cognitive Search. See [Monitoring Azure Cognitive Search](monitor-azure-cognitive-search.md) for details on collecting and analyzing monitoring data for your search service.

## Metrics

This section lists the platform metrics collected for Azure Cognitive Search ([Microsoft.Search/searchServices](../azure-monitor/essentials/metrics-supported.md#microsoftsearchsearchservices)).  

| Metric ID | Unit | Description |
|:-------|:-----|:------------|
| DocumentsProcessedCount | Count | Total of the number of documents successfully processed in an indexing operation (either by an indexer or by pushing documents directly). |
| SearchLatency | Seconds | Average search latency for queries that execute on the search service. |
| SearchQueriesPerSecond | CountPerSecond | Average of the search queries per second (QPS) for the search service. It's common for queries to execute in milliseconds, so only queries that measure as seconds will appear in a metric like QPS. </br>The minimum is the lowest value for search queries per second that was registered during that minute. The same applies to the maximum value. Average is the aggregate across the entire minute. For example, within one minute, you might have a pattern like this: one second of high load that is the maximum for SearchQueriesPerSecond, followed by 58 seconds of average load, and finally one second with only one query, which is the minimum.|
| SkillExecutionCount | Count | Total number of skill executions processed during an indexer operation. |
| ThrottledSearchQueriesPercentage | Percent | Average percentage of the search queries that were throttled from the total number of search queries that executed during a one-minute interval.|

For reference, see a list of [all platform metrics supported in Azure Monitor](/azure/azure-monitor/platform/metrics-supported).

## Metric dimensions

Dimensions of a metric are name/value pairs that carry additional data to describe the metric value. Azure Cognitive Search has the following dimensions associated with its metrics that capture a count of documents or skills that were executed ("Document processed count" and "Skill execution invocation count").

| Dimension Name | Description |
| -------------- | ----------- |
| **DataSourceName** | A named data source connection used during indexer execution. Valid values are one of the [supported data source types](search-indexer-overview.md#supported-data-sources). |
| **Failed** | Indicates whether the instance failed. |
| **IndexerName** | Name of an indexer.|
| **IndexName** | Name of an index.|
| **SkillsetName** | Name of a skillset used during indexer execution. |
| **SkillName** | Name of a skill within a skillset. |
| **SkillType** | The @odata.type of the skill. |

For more information on what metric dimensions are, see [Multi-dimensional metrics](/azure/azure-monitor/platform/data-platform-metrics#multi-dimensional-metrics).

## Resource logs

[Resource logs](../azure-monitor/essentials/resource-logs.md) are platform logs that provide insight into operations that were performed within an Azure resource. Resource logs are generated by the search service automatically, but are not collected by default. You must create a diagnostic setting to send resource logs to a Log Analytics workspace to use with Azure Monitor Logs, Azure Event Hubs to forward outside of Azure, or to Azure Storage for archiving.

This section identifies the type (or category) of resource logs you can collect for Azure Cognitive Search:

+ Resource logs are grouped by type (or category). Azure Cognitive Search generates resource logs under the [**Operations category**](../azure-monitor/essentials/resource-logs-categories.md#microsoftsearchsearchservices).

+ Resource log schema includes common 

For reference, see a list of [all resource logs category types supported in Azure Monitor](/azure/azure-monitor/platform/resource-logs-schema).

## Azure Monitor Logs tables

[Azure Monitor Logs](../azure-monitor/logs/data-platform-logs.md) is a feature of Azure Monitor that collects and organizes log and performance data from monitored resources. One of those resources includes the platform logs generated by Azure Cognitive Search.

This section refers to all of the Azure Monitor Logs Kusto tables relevant to Azure Cognitive Search and available for query by Log Analytics and Metrics Explorer in the Azure portal.

| Table | Description |
|-------|-------------|
| [AzureActivity](/azure/azure-monitor/reference/tables/azureactivity) | Entries from the Azure Activity log that provide insight into control plane operations. Tasks invoked on the control plane, such as adding or removing replicas and partitions, will be represented through a "Get Admin Key" activity. |
| [AzureDiagnostics](/azure/azure-monitor/reference/tables/azurediagnostics) | Logged query and indexing operations.|
| [AzureMetrics](/azure/azure-monitor/reference/tables/azuremetrics) | Metric data emitted by Azure Cognitive Search that measures health and performance. |

For a reference of all Azure Monitor Logs / Log Analytics tables, see the [Azure Monitor Log Table Reference](/azure/azure-monitor/reference/tables/tables-resourcetype#search-services).

### Diagnostics tables

Azure Cognitive Search uses the [**Azure Diagnostics**](/azure/azure-monitor/reference/tables/azurediagnostics) table to collect resource logs related to queries and indexing on your search service.

Queries against this table in Log Analytics can include the common properties, the [search-specific properties](#resource-log-search-props), and the [search-specific operations](#resource-log-search-ops) listed in the schema reference section.

For examples of Kusto queries useful for Azure Cognitive Search, see [Monitoring Azure Cognitive Search](monitor-azure-cognitive-search.md) and [Analyze performance in Azure Cognitive Search](search-performance-analysis.md).

## Activity logs

The following table lists common operations related to Azure Cognitive Search that may be created in the Azure Activity log.

| Operation | Description |
|:----------|:------------|
| Get Admin Key | Any operation that requires administrative rights will be logged as a "Get Admin Key" operation.  |
| Get Query Key | Any read-only operation against the documents collection of an index.  |
| Regenerate Admin Key | A request to regenerate either the primary or secondary admin API key. |

Common entries include references to API keys - generic informational notifications like *Get Admin Key* and *Get Query keys*. These activities indicate requests that were made using the admin key (create or delete objects) or query key, but do not show the request itself. For information of this grain, you must configure diagnostic logging. 

Alternatively, you might gain some insight through change history. In Azure portal, select the activity to open the detail page and then select "Change history" for information about the underlying operation.

For more information on the schema of Activity Log entries, see [Activity  Log schema](../azure-monitor/essentials/activity-log-schema.md).

## Schemas

The following schemas are in use by Azure Cognitive Search. If you are building queries or custom reports, the data structures that contain Azure Cognitive Search resource logs conform to the schema below.

For resource logs sent to blob storage, each blob has one root object called **records** containing an array of log objects. Each blob contains records for all the operations that took place during the same hour.

<a name="resource-log-schema"></a>

### Resource log schema

All resource logs available through Azure Monitor share a [common top-level schema](../azure-monitor/essentials/resource-logs-schema.md#top-level-common-schema). Azure Cognitive Search supplements with [additional properties](#resource-log-search-props) and [operations](#resource-log-search-ops) that are specific to a search service.

A resource log will include a combination of common and search-specific properties, as illustrated by the following example.

| Name | Type | Description and example |
| ---- | ---- | ----------------------- |
| TimeGenerated | Datetime | Timestamp of the operation. For example: `2021-12-07T00:00:43.6872559Z` |
| Resource | String | Resource ID. For example: `/subscriptions/<your-subscription-id>/resourceGroups/<your-resource-group-name>/providers/Microsoft.Search/searchServices/<your-search-service-name>` |
| Category | String | "OperationLogs". This value is a constant. OperationLogs is the only category used for resource logs. |
| OperationName | String |  The name of the operation (see the schemas section for the full list. For example: `Query.Search` |
| OperationVersion | String | The api-version used on the request. For example: `2020-06-30` |
| ResultType | String |"Success". Possible values: Success or Failure |
| ResultSignature | Int | An HTTP result code. For example: `200` |
| DurationMS | Int | Duration of the operation in milliseconds. |
| Properties |Object | Object containing operation-specific data. See the following properties schema table.|

<a name="resource-log-search-props"></a>

#### Properties schema

The properties below are specific to Azure Cognitive Search.

| Name | Type | Description and example |
| ---- | ---- | ----------------------- |
| Description_s | String | The operation's endpoint. For example: `GET /indexes('content')/docs` |
| Documents_d | Int | Number of documents processed. |
| IndexName_s | String | Name of the index associated with the operation. |
| Query_s | String | The query parameters used in the request. For example: `?search=beach access&$count=true&api-version=2020-06-30` |

<a name="resource-log-search-ops"></a>

#### OperationName values (logged operations)

For the OperationName, specify any of the following operations.

| OperationName | Description |
|:------------- |:------------|
| Indexing.Index  | This operation is a call to [Add, Update or Delete Documents](/rest/api/searchservice/addupdate-or-delete-documents). |
| Indexers.Create | Create an indexer explicitly or implicitly through the Import Data wizard. |
| Indexers.Get | Returns the name of an indexer whenever the indexer is run. |
| Indexers.Status | Returns the status of an indexer whenever the indexer is run. |
| DataSources.Get | Returns the name of the data source whenever an indexer is run.|
| Indexes.Get | Returns the name of an index whenever an indexer is run. |
| indexes.Prototype | This is an index created by the Import Data wizard. |
| Query.Autocomplete |  An autocomplete query against an index. See [Query types and composition](search-query-overview.md). |
| Query.Lookup |  A lookup query against an index. See [Query types and composition](search-query-overview.md). |
| Query.Search |  A full text search request against an index. See [Query types and composition](search-query-overview.md). |
| Query.Suggest |  Type-ahead query against an index. See [Query types and composition](search-query-overview.md). |
| ServiceStats | This operation is a routine call to [Get Service Statistics](/rest/api/searchservice/get-service-statistics), either called directly or implicitly to populate a portal overview page when it is loaded or refreshed. |

<!-- 

## Query log information

Two tables contain logs and metrics for Azure Cognitive Search: **AzureDiagnostics** and **AzureMetrics**.

1. Under **Monitoring**, select **Logs**.

1. In the query window, type **AzureMetrics**, check the scope (your search service) and time range, and then click **Run** to get acquainted with the data collected in this table.

   Scroll across the table to view metrics and values. Notice the record count at the top. If your service has been collecting metrics for a while, you might want to adjust the time interval to get a manageable data set.

   ![AzureMetrics table](./media/search-monitor-usage/azuremetrics-table.png "AzureMetrics table")

1. Enter the following query to return a tabular result set.

   ```kusto
   AzureMetrics
   | project MetricName, Total, Count, Maximum, Minimum, Average
   ```

1. Repeat the previous steps, starting with **AzureDiagnostics** to return all columns for informational purposes, followed by a more selective query that extracts more interesting information.

   ```kusto
   AzureDiagnostics
   | project OperationName, resultSignature_d, DurationMs, Query_s, Documents_d, IndexName_s
   | where OperationName == "Query.Search" 
   ```

   ![AzureDiagnostics table](./media/search-monitor-usage/azurediagnostics-table.png "AzureDiagnostics table")

## Kusto query examples

If you enabled diagnostic logging, you can query **AzureDiagnostics** for a list of operations that ran on your service and when. You can also correlate activity to investigate changes in performance.

#### Example: List operations 

Return a list of operations and a count of each one.

```kusto
AzureDiagnostics
| summarize count() by OperationName
```

#### Example: Correlate operations

Correlate query request with indexing operations, and render the data points across a time chart to see operations coincide.

```kusto
AzureDiagnostics
| summarize OperationName, Count=count()
| where OperationName in ('Query.Search', 'Indexing.Index')
| summarize Count=count(), AvgLatency=avg(durationMs) by bin(TimeGenerated, 1h), OperationName
| render timechart
```

## View raw log files

Blob storage is used for archiving log files. You can use any JSON editor to view the log file. If you don't have one, we recommend [Visual Studio Code](https://code.visualstudio.com/download).

1. In Azure portal, open your Storage account. 

2. In the left-navigation pane, click **Blobs**. You should see **insights-logs-operationlogs** and **insights-metrics-pt1m**. These containers are created by Azure Cognitive Search when the log data is exported to Blob storage.

3. Click down the folder hierarchy until you reach the .json file.  Use the context-menu to download the file.

Once the file is downloaded, open it in a JSON editor to view the contents.
 -->

## See also

+ See [Monitoring Azure Cognitive Search](monitor-azure-cognitive-search.md) for concepts and instructions.

+ See [Monitoring Azure resources with Azure Monitor](../azure-monitor/essentials/monitor-azure-resource) for details on monitoring Azure resources.
